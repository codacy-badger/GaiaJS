!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.gaia=t():e.gaia=t()}(global,function(){return function(e){var t,n=!0,r="c8faa418fb33f95c8343",i={},s=[],o=[];function a(e){var n=O[e];if(!n)return x;var r=function(r){return n.hot.active?(O[r]?-1===O[r].parents.indexOf(e)&&O[r].parents.push(e):(s=[e],t=r),-1===n.children.indexOf(r)&&n.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),s=[]),x(r)},i=function(e){return{configurable:!0,enumerable:!0,get:function(){return x[e]},set:function(t){x[e]=t}}};for(var o in x)Object.prototype.hasOwnProperty.call(x,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(r,o,i(o));return r.e=function(e){return"ready"===h&&u("prepare"),_++,x.e(e).then(t,function(e){throw t(),e});function t(){_--,"prepare"===h&&(v[e]||E(e),0===_&&0===l&&S())}},r.t=function(e,t){return 1&t&&(e=r(e)),x.t(e,-2&t)},r}var c=[],h="idle";function u(e){h=e;for(var t=0;t<c.length;t++)c[t].call(null,e)}var p,d,f,l=0,_=0,v={},y={},g={};function m(e){return+e+""===e?+e:e}function b(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return n=e,u("check"),function(){try{var e=require("./"+r+".hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}().then(function(e){if(!e)return u("idle"),null;y={},v={},g=e.c,f=e.h,u("prepare");var t=new Promise(function(e,t){p={resolve:e,reject:t}});return d={},E(0),"prepare"===h&&0===_&&0===l&&S(),t})}function E(e){g[e]?(y[e]=!0,l++,function(e){var t=require("./"+e+"."+r+".hot-update.js");!function(e,t){if(g[e]&&y[e]){for(var n in y[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(d[n]=t[n]);0==--l&&0===_&&S()}}(t.id,t.modules)}(e)):v[e]=!0}function S(){u("ready");var e=p;if(p=null,e)if(n)Promise.resolve().then(function(){return w(n)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var r in d)Object.prototype.hasOwnProperty.call(d,r)&&t.push(m(r));e.resolve(t)}}function w(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var n,o,a,c,p;function l(e){for(var t=[e],n={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var i=r.pop(),s=i.id,o=i.chain;if((c=O[s])&&!c.hot._selfAccepted){if(c.hot._selfDeclined)return{type:"self-declined",chain:o,moduleId:s};if(c.hot._main)return{type:"unaccepted",chain:o,moduleId:s};for(var a=0;a<c.parents.length;a++){var h=c.parents[a],u=O[h];if(u){if(u.hot._declinedDependencies[s])return{type:"declined",chain:o.concat([h]),moduleId:s,parentId:h};-1===t.indexOf(h)&&(u.hot._acceptedDependencies[s]?(n[h]||(n[h]=[]),_(n[h],[s])):(delete n[h],t.push(h),r.push({chain:o.concat([h]),id:h})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var v={},y=[],b={},E=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var S in d)if(Object.prototype.hasOwnProperty.call(d,S)){var w;p=m(S);var C=!1,k=!1,T=!1,P="";switch((w=d[S]?l(p):{type:"disposed",moduleId:S}).chain&&(P="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(C=new Error("Aborted because of self decline: "+w.moduleId+P));break;case"declined":t.onDeclined&&t.onDeclined(w),t.ignoreDeclined||(C=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+P));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(w),t.ignoreUnaccepted||(C=new Error("Aborted because "+p+" is not accepted"+P));break;case"accepted":t.onAccepted&&t.onAccepted(w),k=!0;break;case"disposed":t.onDisposed&&t.onDisposed(w),T=!0;break;default:throw new Error("Unexception type "+w.type)}if(C)return u("abort"),Promise.reject(C);if(k)for(p in b[p]=d[p],_(y,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,p)&&(v[p]||(v[p]=[]),_(v[p],w.outdatedDependencies[p]));T&&(_(y,[w.moduleId]),b[p]=E)}var N,I=[];for(o=0;o<y.length;o++)p=y[o],O[p]&&O[p].hot._selfAccepted&&I.push({module:p,errorHandler:O[p].hot._selfAccepted});u("dispose"),Object.keys(g).forEach(function(e){!1===g[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R,H=y.slice();H.length>0;)if(p=H.pop(),c=O[p]){var D={},j=c.hot._disposeHandlers;for(a=0;a<j.length;a++)(n=j[a])(D);for(i[p]=D,c.hot.active=!1,delete O[p],delete v[p],a=0;a<c.children.length;a++){var M=O[c.children[a]];M&&(N=M.parents.indexOf(p))>=0&&M.parents.splice(N,1)}}for(p in v)if(Object.prototype.hasOwnProperty.call(v,p)&&(c=O[p]))for(R=v[p],a=0;a<R.length;a++)A=R[a],(N=c.children.indexOf(A))>=0&&c.children.splice(N,1);for(p in u("apply"),r=f,b)Object.prototype.hasOwnProperty.call(b,p)&&(e[p]=b[p]);var L=null;for(p in v)if(Object.prototype.hasOwnProperty.call(v,p)&&(c=O[p])){R=v[p];var B=[];for(o=0;o<R.length;o++)if(A=R[o],n=c.hot._acceptedDependencies[A]){if(-1!==B.indexOf(n))continue;B.push(n)}for(o=0;o<B.length;o++){n=B[o];try{n(R)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:p,dependencyId:R[o],error:e}),t.ignoreErrored||L||(L=e)}}}for(o=0;o<I.length;o++){var U=I[o];p=U.module,s=[p];try{x(p)}catch(e){if("function"==typeof U.errorHandler)try{U.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:p,error:n,originalError:e}),t.ignoreErrored||L||(L=n),L||(L=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:p,error:e}),t.ignoreErrored||L||(L=e)}}return L?(u("fail"),Promise.reject(L)):(u("idle"),new Promise(function(e){e(y)}))}var O={};function x(n){if(O[n])return O[n].exports;var r=O[n]={i:n,l:!1,exports:{},hot:function(e){var n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:t!==e,active:!0,accept:function(e,t){if(void 0===e)n._selfAccepted=!0;else if("function"==typeof e)n._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)n._acceptedDependencies[e[r]]=t||function(){};else n._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)n._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)n._declinedDependencies[e[t]]=!0;else n._declinedDependencies[e]=!0},dispose:function(e){n._disposeHandlers.push(e)},addDisposeHandler:function(e){n._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=n._disposeHandlers.indexOf(e);t>=0&&n._disposeHandlers.splice(t,1)},check:b,apply:w,status:function(e){if(!e)return h;c.push(e)},addStatusHandler:function(e){c.push(e)},removeStatusHandler:function(e){var t=c.indexOf(e);t>=0&&c.splice(t,1)},data:i[e]};return t=void 0,n}(n),parents:(o=s,s=[],o),children:[]};return e[n].call(r.exports,r,r.exports,a(n)),r.l=!0,r.exports}return x.m=e,x.c=O,x.d=function(e,t,n){x.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},x.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},x.t=function(e,t){if(1&t&&(e=x(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(x.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)x.d(n,r,function(t){return e[t]}.bind(null,r));return n},x.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return x.d(t,"a",t),t},x.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},x.p="",x.h=function(){return r},a(26)(x.s=26)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=function(){function e(e){this.name=e}return e.isNested=function(e){return e.hasClass("block")||"TD"===e.prop("tagName")},e.renderElements=function(e,t,n){var i=new r.Renderer(e);Array.from(t.elements).map(function(e){return Object.assign(e,{position:t.position})}).forEach(function(e){return i.render(e,n)})},e}();t.MarkupComponent=i},function(e,t){e.exports=require("util")},function(e,t,n){(function(){var e,r,i;e=n(5),t.array_intersection=function(e,t){var n,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)n=e[r],-1!==t.indexOf(n)&&s.push(n);return s},t.escape_selected=function(e,t){var n,r,i,s,o,a,c,h,u,p;for(a={},i=0,o=(t="%"+t).length;i<o;i++)a[n=t[i]]=escape(n);for(h=new RegExp("(["+t+"])"),r=s=0,u=(c=e.split(h)).length;0<=u?s<u:s>u;r=0<=u?++s:--s)1===(p=c[r]).length&&p in a&&(c[r]=a[p]);return c.join("")},t.buffer_concat=function(e,t){var n;return n=new Buffer(e.length+t.length),e.copy(n),t.copy(n,e.length),n},t.md5_hex=function(t){return e.createHash("md5").update(t).digest("hex")},t.sha1_base64=function(t){return e.createHash("sha1").update(t).digest("base64")},t.timeout_chain=function(e){var n,r,i;if((e=e.slice(0)).length)return r=(n=e.shift())[0],i=n[1],setTimeout(function(){return i(),t.timeout_chain(e)},r)},t.objectExtend=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},t.overshadowListeners=function(e,t,n){var r,i;return i=e.listeners(t).slice(0),e.removeAllListeners(t),r=function(){var e,t;if(!0!==n.apply(this,arguments)){for(e=0,t=i.length;e<t;e++)i[e].apply(this,arguments);return!1}return!0},e.addListener(t,r)},i=function(e){var t,n,r;return r={},t=function(){var e,t;for(t=[],n=e=0;e<65536;n=++e)t.push(String.fromCharCode(n));return t}(),e.lastIndex=0,t.join("").replace(e,function(e){return r[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}),r}(r=/[\x00-\x1f\ud800-\udfff\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufff0-\uffff]/g),t.quote=function(e){var t;return t=JSON.stringify(e),r.lastIndex=0,r.test(t)?t.replace(r,function(e){return i[e]}):t},t.parseCookie=function(e){var t,n,r,i,s;if(t={},e)for(n=0,r=(s=e.split(";")).length;n<r;n++)t[(i=s[n].split("="))[0].trim()]=(i[1]||"").trim();return t},t.random32=function(){var t,n;return(n=[(t=e.randomBytes(4))[0],t[1],t[2],t[3]])[0]+256*n[1]+256*n[2]*256+256*n[3]*256*256}}).call(this)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(40);var r=function(){function e(e){this.text=e}return e.prototype.render=function(){var e=document.createElement("div");return e.classList.add("inline-text"),e.appendChild(document.createTextNode(this.text)),e},e}();t.InlineText=r},function(e,t,n){"use strict";var r=n(19).EventEmitter,i=n(1),s=n(83),o=n(15),a=n(84),c=function(e,t,n){r.call(this),c.validateOptions(n||{},["maxLength","masking","requireMasking","protocols"]),this._request=e,this._reader=new a,this._options=n||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new o,this.__queue=[],this.readyState=0,this.url=t,this.io=new s.IO(this),this.messages=new s.Messages(this),this._bindEventListeners()};i.inherits(c,r),c.validateOptions=function(e,t){for(var n in e)if(t.indexOf(n)<0)throw new Error("Unrecognized option: "+n)};var h={MAX_LENGTH:67108863,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var e=this;this.messages.on("error",function(){}),this.on("message",function(t){var n=e.messages;n.readable&&n.emit("data",t.data)}),this.on("error",function(t){var n=e.messages;n.readable&&n.emit("error",t)}),this.on("close",function(){var t=e.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(e){return!1},setHeader:function(e,t){return!(this.readyState>0||(this._headers.set(e,t),0))},start:function(){if(0!==this.readyState)return!1;var e=this._handshakeResponse();return!!e&&(this._write(e),-1!==this._stage&&this._open(),!0)},text:function(e){return this.frame(e)},binary:function(e){return!1},ping:function(){return!1},pong:function(){return!1},close:function(e,t){return 1===this.readyState&&(this.readyState=3,this.emit("close",new c.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(e){this.frame.apply(this,e)},this),this.__queue=[],this.emit("open",new c.OpenEvent)},_queue:function(e){return this.__queue.push(e),!0},_write:function(e){var t=this.io;t.readable&&t.emit("data",e)}};for(var u in h)c.prototype[u]=h[u];c.ConnectEvent=function(){},c.OpenEvent=function(){},c.CloseEvent=function(e,t){this.code=e,this.reason=t},c.MessageEvent=function(e){this.data=e},c.PingEvent=function(e){this.data=e},c.PongEvent=function(e){this.data=e},e.exports=c},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("stream")},function(e,t,n){(function(){var e,r,i,s,o,a,c,h,u,p,d,f=function(e,t){for(var n in t)l.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},l={}.hasOwnProperty;u=n(6),d=n(102),p=n(2),(a=function(){}).CONNECTING=0,a.OPEN=1,a.CLOSING=2,a.CLOSED=3,c=function(e,t){return"c"+JSON.stringify([e,t])},(o=function(e){function t(e){this._session=e,this.id=d(),this.headers={},this.prefix=this._session.prefix}return f(t,e),t.prototype.toString=function(){return"<SockJSConnection "+this.id+">"},t.prototype.write=function(e){return this._session.send(""+e)},t.prototype.end=function(e){return e&&this.write(e),this.close(),null},t.prototype.close=function(e,t){return this._session.close(e,t)},t.prototype.destroy=function(){return this.end(),this.removeAllListeners()},t.prototype.destroySoon=function(){return this.destroy()},t}(u.Stream)).prototype.__defineGetter__("readable",function(){return this._session.readyState===a.OPEN}),o.prototype.__defineGetter__("writable",function(){return this._session.readyState===a.OPEN}),o.prototype.__defineGetter__("readyState",function(){return this._session.readyState}),r={},(s=function(){function e(e,t){this.session_id=e,this.heartbeat_delay=t.options.heartbeat_delay,this.disconnect_delay=t.options.disconnect_delay,this.prefix=t.options.prefix,this.send_buffer=[],this.is_closing=!1,this.readyState=a.CONNECTING,this.session_id&&(r[this.session_id]=this),this.timeout_cb=function(e){return function(){return e.didTimeout()}}(this),this.to_tref=setTimeout(this.timeout_cb,this.disconnect_delay),this.connection=new o(this),this.emit_open=function(e){return function(){return e.emit_open=null,t.emit("connection",e.connection)}}(this)}return e.prototype.register=function(e,t){return this.recv?(t.doSendFrame(c(2010,"Another connection still open")),void t.didClose()):(this.to_tref&&(clearTimeout(this.to_tref),this.to_tref=null),this.readyState===a.CLOSING?(this.flushToRecv(t),t.doSendFrame(this.close_frame),t.didClose(),void(this.to_tref=setTimeout(this.timeout_cb,this.disconnect_delay))):(this.recv=t,this.recv.session=this,this.decorateConnection(e),this.readyState===a.CONNECTING&&(this.recv.doSendFrame("o"),this.readyState=a.OPEN,process.nextTick(this.emit_open)),void(this.recv&&this.tryFlush())))},e.prototype.decorateConnection=function(e){var t,n,r,i,s,o,a,c,h;(h=this.recv.connection)||(h=this.recv.response.connection);try{a=h.remoteAddress,c=h.remotePort,t=h.address()}catch(e){}for(a&&(this.connection.remoteAddress=a,this.connection.remotePort=c,this.connection.address=t),this.connection.url=e.url,this.connection.pathname=e.pathname,this.connection.protocol=this.recv.protocol,n={},r=0,s=(o=["referer","x-client-ip","x-forwarded-for","x-forwarded-host","x-forwarded-port","x-cluster-client-ip","via","x-real-ip","x-forwarded-proto","x-ssl","dnt","host","user-agent","accept-language"]).length;r<s;r++)i=o[r],e.headers[i]&&(n[i]=e.headers[i]);if(n)return this.connection.headers=n},e.prototype.unregister=function(){var e;return e=this.recv.delay_disconnect,this.recv.session=null,this.recv=null,this.to_tref&&clearTimeout(this.to_tref),e?this.to_tref=setTimeout(this.timeout_cb,this.disconnect_delay):this.timeout_cb()},e.prototype.flushToRecv=function(e){var t,n;return this.send_buffer.length>0&&(n=(t=[this.send_buffer,[]])[0],this.send_buffer=t[1],e.doSendBulk(n),!0)},e.prototype.tryFlush=function(){var e;this.flushToRecv(this.recv)&&this.to_tref||(this.to_tref&&clearTimeout(this.to_tref),e=function(t){return function(){if(t.recv)return t.to_tref=setTimeout(e,t.heartbeat_delay),t.recv.heartbeat()}}(this),this.to_tref=setTimeout(e,this.heartbeat_delay))},e.prototype.didTimeout=function(){if(this.to_tref&&(clearTimeout(this.to_tref),this.to_tref=null),this.readyState!==a.CONNECTING&&this.readyState!==a.OPEN&&this.readyState!==a.CLOSING)throw Error("INVALID_STATE_ERR");if(this.recv)throw Error("RECV_STILL_THERE");if(this.readyState=a.CLOSED,this.connection.emit("end"),this.connection.emit("close"),this.connection=null,this.session_id)return delete r[this.session_id],this.session_id=null},e.prototype.didMessage=function(e){this.readyState===a.OPEN&&this.connection.emit("data",e)},e.prototype.send=function(e){return this.readyState===a.OPEN&&(this.send_buffer.push(""+e),this.recv&&this.tryFlush(),!0)},e.prototype.close=function(e,t){return null==e&&(e=1e3),null==t&&(t="Normal closure"),this.readyState===a.OPEN&&(this.readyState=a.CLOSING,this.close_frame=c(e,t),this.recv&&(this.recv.doSendFrame(this.close_frame),this.recv&&this.recv.didClose(),this.recv&&this.unregister()),!0)},e}()).bySessionId=function(e){return e&&r[e]||null},h=function(e,t,n,r){var i;return(i=s.bySessionId(n))||(i=new s(n,t)),i.register(e,r),i},t.register=function(e,t,n){return h(e,t,e.session,n)},t.registerNoSession=function(e,t,n){return h(e,t,void 0,n)},e=function(){function e(e){this.thingy=e,this.setUp(this.thingy)}return e.prototype.setUp=function(){return this.thingy_end_cb=function(e){return function(){return e.didAbort()}}(this),this.thingy.addListener("close",this.thingy_end_cb),this.thingy.addListener("end",this.thingy_end_cb)},e.prototype.tearDown=function(){return this.thingy.removeListener("close",this.thingy_end_cb),this.thingy.removeListener("end",this.thingy_end_cb),this.thingy_end_cb=null},e.prototype.didAbort=function(){return this.delay_disconnect=!1,this.didClose()},e.prototype.didClose=function(){if(this.thingy&&(this.tearDown(this.thingy),this.thingy=null),this.session)return this.session.unregister()},e.prototype.doSendBulk=function(e){var t,n;return n=function(){var n,r,i;for(i=[],n=0,r=e.length;n<r;n++)t=e[n],i.push(p.quote(t));return i}(),this.doSendFrame("a["+n.join(",")+"]")},e.prototype.heartbeat=function(){return this.doSendFrame("h")},e}(),i=function(t){function n(e,t,r){this.request=e,this.response=t,this.options=r,this.curr_response_size=0;try{this.request.connection.setKeepAlive(!0,5e3)}catch(e){}n.__super__.constructor.call(this,this.request.connection),void 0===this.max_response_size&&(this.max_response_size=this.options.response_limit)}return f(n,e),n.prototype.max_response_size=void 0,n.prototype.delay_disconnect=!0,n.prototype.doSendFrame=function(e){var t;this.curr_response_size+=e.length,t=!1;try{this.response.write(e),t=!0}catch(e){}return this.max_response_size&&this.curr_response_size>=this.max_response_size&&this.didClose(),t},n.prototype.didClose=function(){n.__super__.didClose.apply(this,arguments);try{this.response.end()}catch(e){}return this.response=null},n}(),t.GenericReceiver=e,t.Transport=a,t.Session=s,t.ResponseReceiver=i,t.SockJSConnection=o}).call(this)},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";var r=n(4),i=n(85),s=n(96),o={client:function(e,t){return void 0===(t=t||{}).masking&&(t.masking=!0),new i(e,t)},server:function(e){return void 0===(e=e||{}).requireMasking&&(e.requireMasking=!0),new s(e)},http:function(){return s.http.apply(s,arguments)},isSecureRequest:function(e){return s.isSecureRequest(e)},isWebSocket:function(e){if("GET"!==e.method)return!1;var t=e.headers.connection||"",n=e.headers.upgrade||"";return"GET"===e.method&&t.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&"websocket"===n.toLowerCase()},validateOptions:function(e,t){r.validateOptions(e,t)}};e.exports=o},function(e,t){var n=function(e,t){for(var n in this.type=e,t)this[n]=t[n]};n.prototype.initEvent=function(e,t,n){this.type=e,this.bubbles=t,this.cancelable=n},n.prototype.stopPropagation=function(){},n.prototype.preventDefault=function(){},n.CAPTURING_PHASE=1,n.AT_TARGET=2,n.BUBBLING_PHASE=3,e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(31);var r=function(){function e(e){this.position=e}return e.prototype.render=function(){var e=document.createElement("div");return e.classList.add("text-icon",this.position),e},e}();t.TextIcon=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(33);var r=function(){function e(){}return e.render=function(){var e=new Date,t=function(e){return e.toString().padStart(2,"0")},n=document.createElement("span");return n.classList.add("text-time"),n.appendChild(document.createTextNode(t(e.getHours())+":"+t(e.getMinutes()))),n},e}();t.TextTime=r},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=function(){this.clear()};r.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"],r.prototype.clear=function(){this._sent={},this._lines=[]},r.prototype.set=function(e,t){if(void 0!==t){e=this._strip(e),t=this._strip(t);var n=e.toLowerCase();(!this._sent.hasOwnProperty(n)||this.ALLOWED_DUPLICATES.indexOf(n)>=0)&&(this._sent[n]=!0,this._lines.push(e+": "+t+"\r\n"))}},r.prototype.toString=function(){return this._lines.join("")},r.prototype._strip=function(e){return e.toString().replace(/^ */,"").replace(/ *$/,"")},e.exports=r},function(e,t,n){"use strict";var r=n(86).HTTPParser,i=process.version.match(/[0-9]+/g).map(function(e){return parseInt(e,10)}),s={request:r.REQUEST||"request",response:r.RESPONSE||"response"},o=function(e){this._type=e,this._parser=new r(s[e]),this._complete=!1,this.headers={};var t=null,n=this;this._parser.onHeaderField=function(e,n,r){t=e.toString("utf8",n,n+r).toLowerCase()},this._parser.onHeaderValue=function(e,r,i){var s=e.toString("utf8",r,r+i);n.headers.hasOwnProperty(t)?n.headers[t]+=", "+s:n.headers[t]=s},this._parser.onHeadersComplete=this._parser[r.kOnHeadersComplete]=function(e,t,r,i,s,a){var c=arguments[0];if("object"==typeof c&&(i=c.method,s=c.url,a=c.statusCode,r=c.headers),n.method="number"==typeof i?o.METHODS[i]:i,n.statusCode=a,n.url=s,r){for(var h,u,p=0,d=r.length;p<d;p+=2)h=r[p].toLowerCase(),u=r[p+1],n.headers.hasOwnProperty(h)?n.headers[h]+=", "+u:n.headers[h]=u;n._complete=!0}}};o.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"},0===i[0]&&12===i[1]&&(o.METHODS[16]="REPORT",o.METHODS[17]="MKACTIVITY",o.METHODS[18]="CHECKOUT",o.METHODS[19]="MERGE",o.METHODS[20]="M-SEARCH",o.METHODS[21]="NOTIFY",o.METHODS[22]="SUBSCRIBE",o.METHODS[23]="UNSUBSCRIBE",o.METHODS[24]="PATCH",o.METHODS[25]="PURGE"),o.prototype.isComplete=function(){return this._complete},o.prototype.parse=function(e){var t=this._parser.execute(e,0,e.length);if("number"!=typeof t)return this.error=t,void(this._complete=!0);0===i[0]&&i[1]<6&&(t+=1),this._complete&&(this.body=t<e.length?e.slice(t):new Buffer(0))},e.exports=o},function(e,t,n){var r=n(6).Stream,i=n(1),s=n(9),o=n(25),a=n(10),c=function(e){e=e||{},s.validateOptions(e,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var t=e.headers;if(t)for(var n in t)this._driver.setHeader(n,t[n]);var r=e.extensions;r&&[].concat(r).forEach(this._driver.addExtension,this._driver),this._ping=e.ping,this._pingId=0,this.readyState=c.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var i=this;this._driver.on("open",function(e){i._open()}),this._driver.on("message",function(e){i._receiveMessage(e.data)}),this._driver.on("close",function(e){i._beginClose(e.reason,e.code)}),this._driver.on("error",function(e){i._emitError(e.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){i.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){i._pingId+=1,i.ping(i._pingId.toString())},1e3*this._ping)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};i.inherits(c,r),c.CONNECTING=0,c.OPEN=1,c.CLOSING=2,c.CLOSED=3;var h={write:function(e){return this.send(e)},end:function(e){void 0!==e&&this.send(e),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(e){return!(this.readyState>c.OPEN)&&(e instanceof Buffer||(e=String(e)),this._driver.messages.write(e))},ping:function(e,t){return!(this.readyState>c.OPEN)&&this._driver.ping(e,t)},close:function(e,t){if(void 0===e&&(e=1e3),void 0===t&&(t=""),1e3!==e&&(e<3e3||e>4999))throw new Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+e+" is neither.");this.readyState!==c.CLOSED&&(this.readyState=c.CLOSING),this._driver.close(t,e)},_configureStream:function(){var e=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(t){this._stream.on(t,function(){e._finalizeClose()})},this),this._stream.on("error",function(t){e._emitError("Network error: "+e.url+": "+t.message),e._finalizeClose()})},_open:function(){if(this.readyState===c.CONNECTING){this.readyState=c.OPEN,this.protocol=this._driver.protocol||"";var e=new a("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},_receiveMessage:function(e){if(this.readyState>c.OPEN)return!1;this.readable&&this.emit("data",e);var t=new a("message",{data:e});t.initEvent("message",!1,!1),this.dispatchEvent(t)},_emitError:function(e){if(!(this.readyState>=c.CLOSING)){var t=new a("error",{message:e});t.initEvent("error",!1,!1),this.dispatchEvent(t)}},_beginClose:function(e,t){this.readyState!==c.CLOSED&&(this.readyState=c.CLOSING,this._closeParams=[e,t],this._stream&&(this._stream.end(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==c.CLOSED){this.readyState=c.CLOSED,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var e=this._closeParams?this._closeParams[0]:"",t=this._closeParams?this._closeParams[1]:1006,n=new a("close",{code:t,reason:e});n.initEvent("close",!1,!1),this.dispatchEvent(n)}}};for(var u in h)c.prototype[u]=h[u];for(var p in o)c.prototype[p]=o[p];e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(30),i=n(39),s=n(44),o=n(47),a=n(50),c=n(53),h=n(56),u=n(59),p=n(62),d=n(65),f=n(68),l=n(71),_=n(74),v=n(75),y=function(){function e(e){this.components=[r.Block,i.Bold,s.Button,c.Headline,h.Image,u.Item,p.Items,d.Link,v.Text,_.Table,f.Row,a.Col,o.Checkbox,l.Submit],this.container=e}return e.prototype.render=function(e,t){var n=this,r=this.getElement(e);return Array.isArray(r)?r.map(function(e){return n.renderElement(e,t)}):this.renderElement(r,t)},e.prototype.renderElement=function(e,t){if(this.container){e.render(this.container,t);var n=document.createElement("div");n.setAttribute("style","clear:both"),this.container.appendChild(n)}},e.prototype.getElement=function(e){var t=Object.create(this.components[e.type.toUpperCase()]);return t.constructor.apply(t,e),t},e}();t.Renderer=y},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";var r=n(5),i=n(1),s=n(88),o=n(4),a=n(93),c=n(94),h=function(e,t,n){if(o.apply(this,arguments),this._extensions=new s,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},"string"==typeof this._protocols&&(this._protocols=this._protocols.split(/ *, */)),this._request){var r=this._request.headers["sec-websocket-key"],i=this._request.headers["sec-websocket-protocol"],a=this._request.headers["sec-websocket-version"],c=this._protocols;this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",h.generateAccept(r)),void 0!==i&&("string"==typeof i&&(i=i.split(/ *, */)),this.protocol=i.filter(function(e){return c.indexOf(e)>=0})[0],this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol)),this.version="hybi-"+a}};i.inherits(h,o),h.mask=function(e,t,n){if(!t||0===t.length)return e;n=n||0;for(var r=0,i=e.length-n;r<i;r++)e[n+r]=e[n+r]^t[r%4];return e},h.generateAccept=function(e){var t=r.createHash("sha1");return t.update(e+h.GUID),t.digest("base64")},h.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var u={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(e){return this._extensions.add(e),!0},parse:function(e){this._reader.put(e);for(var t=!0;t;)switch(this._stage){case 0:(t=this._reader.read(1))&&this._parseOpcode(t[0]);break;case 1:(t=this._reader.read(1))&&this._parseLength(t[0]);break;case 2:(t=this._reader.read(this._frame.lengthBytes))&&this._parseExtendedLength(t);break;case 3:(t=this._reader.read(4))&&(this._stage=4,this._frame.maskingKey=t);break;case 4:(t=this._reader.read(this._frame.length))&&(this._stage=0,this._emitFrame(t));break;default:t=null}},text:function(e){return!(this.readyState>1)&&this.frame(e,"text")},binary:function(e){return!(this.readyState>1)&&this.frame(e,"binary")},ping:function(e,t){return!(this.readyState>1)&&(e=e||"",t&&(this._pingCallbacks[e]=t),this.frame(e,"ping"))},pong:function(e){return!(this.readyState>1)&&(e=e||"",this.frame(e,"pong"))},close:function(e,t){return e=e||"",t=t||this.ERRORS.normal_closure,this.readyState<=0?(this.readyState=3,this.emit("close",new o.CloseEvent(t,e)),!0):1===this.readyState&&(this.readyState=2,this._extensions.close(function(){this.frame(e,"close",t)},this),!0)},frame:function(e,t,n){if(this.readyState<=0)return this._queue([e,t,n]);if(this.readyState>2)return!1;e instanceof Array&&(e=new Buffer(e)),"number"==typeof e&&(e=e.toString());var i,s,o=new c,h="string"==typeof e;o.rsv1=o.rsv2=o.rsv3=!1,o.opcode=this.OPCODES[t||(h?"text":"binary")],i=h?new Buffer(e,"utf8"):e,n&&(s=i,(i=new Buffer(2+s.length)).writeUInt16BE(n,0),s.copy(i,2)),o.data=i;var u=function(e){var t=new a;t.final=!0,t.rsv1=e.rsv1,t.rsv2=e.rsv2,t.rsv3=e.rsv3,t.opcode=e.opcode,t.masked=!!this._masking,t.length=e.data.length,t.payload=e.data,t.masked&&(t.maskingKey=r.randomBytes(4)),this._sendFrame(t)};return this.MESSAGE_OPCODES.indexOf(o.opcode)>=0?this._extensions.processOutgoingMessage(o,function(e,t){if(e)return this._fail("extension_error",e.message);u.call(this,t)},this):u.call(this,o),!0},_sendFrame:function(e){var t=e.length,n=t<=125?2:t<=65535?4:10,r=n+(e.masked?4:0),i=new Buffer(r+t),s=e.masked?this.MASK:0;i[0]=(e.final?this.FIN:0)|(e.rsv1?this.RSV1:0)|(e.rsv2?this.RSV2:0)|(e.rsv3?this.RSV3:0)|e.opcode,t<=125?i[1]=s|t:t<=65535?(i[1]=126|s,i.writeUInt16BE(t,2)):(i[1]=127|s,i.writeUInt32BE(Math.floor(t/4294967296),2),i.writeUInt32BE(t%4294967296,6)),e.payload.copy(i,r),e.masked&&(e.maskingKey.copy(i,n),h.mask(i,e.maskingKey,r)),this._write(i)},_handshakeResponse:function(){try{var e=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"])}catch(e){return this._fail("protocol_error",e.message)}e&&this._headers.set("Sec-WebSocket-Extensions",e);var t=["HTTP/1.1 101 Switching Protocols",this._headers.toString(),""];return new Buffer(t.join("\r\n"),"utf8")},_shutdown:function(e,t,n){delete this._frame,delete this._message,this._stage=5;var r=1===this.readyState;this.readyState=2,this._extensions.close(function(){r&&this.frame(t,"close",e),this.readyState=3,n&&this.emit("error",new Error(t)),this.emit("close",new o.CloseEvent(e,t))},this)},_fail:function(e,t){this.readyState>1||this._shutdown(this.ERRORS[e],t,!0)},_parseOpcode:function(e){var t=[this.RSV1,this.RSV2,this.RSV3].map(function(t){return(e&t)===t}),n=this._frame=new a;return n.final=(e&this.FIN)===this.FIN,n.rsv1=t[0],n.rsv2=t[1],n.rsv3=t[2],n.opcode=e&this.OPCODE,this._stage=1,this._extensions.validFrameRsv(n)?this.OPCODE_CODES.indexOf(n.opcode)<0?this._fail("protocol_error","Unrecognized frame opcode: "+n.opcode):this.MESSAGE_OPCODES.indexOf(n.opcode)<0&&!n.final?this._fail("protocol_error","Received fragmented control frame: opcode = "+n.opcode):this._message&&this.OPENING_OPCODES.indexOf(n.opcode)>=0?this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished"):void 0:this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(n.rsv1?1:0)+", reserved2 = "+(n.rsv2?1:0)+", reserved3 = "+(n.rsv3?1:0))},_parseLength:function(e){var t=this._frame;if(t.masked=(e&this.MASK)===this.MASK,t.length=e&this.LENGTH,t.length>=0&&t.length<=125){if(this._stage=t.masked?3:4,!this._checkFrameLength())return}else this._stage=2,t.lengthBytes=126===t.length?2:8;if(this._requireMasking&&!t.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(e){var t=this._frame;if(t.length=this._readUInt(e),this._stage=t.masked?3:4,this.MESSAGE_OPCODES.indexOf(t.opcode)<0&&t.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+t.length);this._checkFrameLength()},_checkFrameLength:function(){return!((this._message?this._message.length:0)+this._frame.length>this._maxLength&&(this._fail("too_large","WebSocket frame length too large"),1))},_emitFrame:function(e){var t,n,r,i,s,a=this._frame,u=a.payload=h.mask(e,a.maskingKey),p=a.opcode;if(delete this._frame,p===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(a)}if(p!==this.OPCODES.text&&p!==this.OPCODES.binary||(this._message=new c,this._message.pushFrame(a)),a.final&&this.MESSAGE_OPCODES.indexOf(p)>=0)return this._emitMessage(this._message);p===this.OPCODES.close&&(n=u.length>=2?u.readUInt16BE(0):null,r=u.length>2?this._encode(u.slice(2)):null,0!==u.length&&!(null!==n&&n>=this.MIN_RESERVED_ERROR&&n<=this.MAX_RESERVED_ERROR)&&this.ERROR_CODES.indexOf(n)<0&&(n=this.ERRORS.protocol_error),(u.length>125||u.length>2&&!r)&&(n=this.ERRORS.protocol_error),this._shutdown(n||this.DEFAULT_ERROR_CODE,r||"")),p===this.OPCODES.ping&&(this.frame(u,"pong"),this.emit("ping",new o.PingEvent(u.toString()))),p===this.OPCODES.pong&&(s=(i=this._pingCallbacks)[t=this._encode(u)],delete i[t],s&&s(),this.emit("pong",new o.PongEvent(u.toString())))},_emitMessage:function(e){(e=this._message).read(),delete this._message,this._extensions.processIncomingMessage(e,function(e,t){if(e)return this._fail("extension_error",e.message);var n=t.data;if(t.opcode===this.OPCODES.text&&(n=this._encode(n)),null===n)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new o.MessageEvent(n))},this)},_encode:function(e){try{var t=e.toString("binary",0,e.length);if(!this.UTF8_MATCH.test(t))return null}catch(e){}return e.toString("utf8",0,e.length)},_readUInt:function(e){return 2===e.length?e.readUInt16BE(0):4294967296*e.readUInt32BE(0)+e.readUInt32BE(4)}};for(var p in u)h.prototype[p]=u[p];e.exports=h},function(e,t,n){"use strict";var r=function(e){this._bufferSize=e,this.clear()};r.prototype.clear=function(){this._buffer=new Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0},r.prototype.push=function(e){var t=!1,n=!1;this._ringSize<this._bufferSize?t=0===this._tail:this._ringOffset===this._ringSize&&(t=!0,n=0===this._tail),t&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(new Array(this._bufferSize)),this._bufferSize=this._buffer.length,n&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=e,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize},r.prototype.peek=function(){if(0!==this.length)return this._buffer[this._head]},r.prototype.shift=function(){if(0!==this.length){var e=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,0===this._ringOffset&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,e}},e.exports=r},function(e,t,n){"use strict";var r=n(22),i=function(){this._complete=!1,this._callbacks=new r(i.QUEUE_SIZE)};i.QUEUE_SIZE=4,i.all=function(e){var t=new i,n=e.length,r=n;for(0===n&&t.done();r--;)e[r].then(function(){0==(n-=1)&&t.done()});return t},i.prototype.then=function(e){this._complete?e():this._callbacks.push(e)},i.prototype.done=function(){this._complete=!0;for(var e,t=this._callbacks;e=t.shift();)e()},e.exports=i},function(e,t,n){"use strict";var r=n(4),i=function(e,t,n){r.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};n(1).inherits(i,r);var s={close:function(){return 3!==this.readyState&&(this.readyState=3,this.emit("close",new r.CloseEvent(null,null)),!0)},parse:function(e){this.readyState>1||(this._reader.put(e),this._reader.eachByte(function(e){var t;switch(this._stage){case-1:this._body.push(e),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(e);break;case 1:if(this._length=(127&e)+128*this._length,this._closing&&0===this._length)return this.close();128!=(128&e)&&(0===this._length?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(255===e)this._stage=0,t=new Buffer(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new r.MessageEvent(t));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(e),this._buffer.length>this._maxLength)return this.close()}},this))},frame:function(e){if(0===this.readyState)return this._queue([e]);if(this.readyState>1)return!1;"string"!=typeof e&&(e=e.toString());var t=new Buffer(e,"utf8"),n=new Buffer(t.length+2);return n[0]=0,n[t.length+1]=255,t.copy(n,1),this._write(n),!0},_handshakeResponse:function(){var e=["HTTP/1.1 101 Web Socket Protocol Handshake",this._headers.toString(),""];return new Buffer(e.join("\r\n"),"utf8")},_parseLeadingByte:function(e){128==(128&e)?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(var o in s)i.prototype[o]=s[o];e.exports=i},function(e,t,n){var r=n(10),i={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(e,t,n){this.on(e,t)},removeEventListener:function(e,t,n){this.removeListener(e,t)},dispatchEvent:function(e){e.target=e.currentTarget=this,e.eventPhase=r.AT_TARGET,this["on"+e.type]&&this["on"+e.type](e),this.emit(e.type,e)}};e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27);n(111),t.default=r.GaiaChannel},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),i=n(29),s=n(18),o=function(){function e(e,t){void 0===t&&(t=new i.Emitter),this.sockJS=n(76),this.emitter=t,this.renderer=new s.Renderer(e)}return e.getSessionId=function(e){var t=/\/([^\/]+)\/websocket/.exec(e.websocket.ws._transport.url);return t?t[1]:null},e.prototype.connect=function(e,t){var n=this;return void 0===this.websocket?(localStorage.setItem("gaia.url",e),localStorage.setItem("gaia.idt",t),new Promise(function(i,s){n.emitter.onConnecting(e,t),n.websocket=r.default.over(n.sockJS(e)),n.websocket.debug=function(){};var o={};o["gaia.uid"]=localStorage.getItem("gaia.uid"),o["gaia.sig"]=localStorage.getItem("gaia.sig"),o["gaia.idt"]=localStorage.getItem("gaia.idt"),n.websocket.connect(o,n.onOpen(n,i),n.onError(n,s))})):Promise.resolve(t)},e.prototype.disconnect=function(){var e=this;return void 0!==this.websocket?new Promise(function(t){e.websocket.disconnect(function(){var n=localStorage.getItem("gaia.url"),r=localStorage.getItem("gaia.idt");e.emitter.onDisconnected(n,r),t()})}):Promise.resolve()},e.prototype.sendMessage=function(t){try{document.getElementsByClassName("button.left").item(0).remove();var n=Object.assign(t,{position:"right",timestamp:(new Date).getTime()});return this.websocket.send("/app/"+e.getSessionId(this),{identity:localStorage.getItem("gaia.idt")},JSON.stringify(n)),this.renderer.render(n,null),Promise.resolve(t)}catch(e){return this.onError(this)(e),Promise.reject(e)}},e.prototype.onOpen=function(t,n){var r=this;return function(i){var s=localStorage.getItem("gaia.url"),o=localStorage.getItem("gaia.idt");t.websocket.subscribe("/queue/"+e.getSessionId(t),r.onMessage(t),{identity:o}),t.emitter.onConnected(s,o),n()}},e.prototype.onError=function(e,t){return function(n){t&&t(),e.emitter.onError(n),setTimeout(function(){var t=localStorage.getItem("gaia.url"),n=localStorage.getItem("gaia.idt");e.emitter.onReconnecting(t,n),e.connect(t,n)},5e3)}},e.prototype.onMessage=function(e){var t=this;return function(n){var r=JSON.parse(n.body);r.type?(e.emitter.onMessage(Object.assign(r,{position:"left"})),e.renderer.render(Object.assign(r,{position:"left"}),t.sendMessage.bind(t))):r.uid&&r.sig&&(e.emitter.onMessage(r),localStorage.setItem("gaia.uid",r.uid),localStorage.setItem("gaia.sig",r.sig))}},e}();t.GaiaChannel=o},function(e,t,n){e.exports=function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,s=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw s}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r={V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.2,1.1,1.0"},supportedProtocols:function(){return["v10.stomp","v11.stomp","v12.stomp"]}},i={"v10.stomp":r.V1_0,"v11.stomp":r.V1_1,"v12.stomp":r.V1_2},s="\n",o="\0",a=function(e){return e.replace(/^\s+|\s+$/g,"")};function c(){return(new Date).getTime()+"-"+Math.floor(1e3*Math.random())}var h=function(){function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e(this,n),this.command=t,this.headers=r,this.body=i}return t(n,[{key:"toString",value:function(){var e=this,t=[this.command],n=!1===this.headers["content-length"];return n&&delete this.headers["content-length"],Object.keys(this.headers).forEach(function(n){var r=e.headers[n];t.push(n+":"+r)}),this.body&&!n&&t.push("content-length:"+function(e){return e?encodeURIComponent(e).match(/%..|./g).length:0}(this.body)),t.push(s+this.body),t.join(s)}}],[{key:"unmarshallSingle",value:function(e){var t=e.search(new RegExp(s+s)),r=e.substring(0,t).split(s),i=r.shift(),c={},h="",u=t+2,p=!0,d=!1,f=void 0;try{for(var l,_=r.reverse()[Symbol.iterator]();!(p=(l=_.next()).done);p=!0){var v=l.value,y=v.indexOf(":");c[a(v.substring(0,y))]=a(v.substring(y+1))}}catch(e){d=!0,f=e}finally{try{!p&&_.return&&_.return()}finally{if(d)throw f}}if(c["content-length"]){var g=parseInt(c["content-length"],10);h=(""+e).substring(u,u+g)}else for(var m=null,b=u;b<e.length&&(m=e.charAt(b))!==o;b++)h+=m;return new n(i,c,h)}},{key:"unmarshall",value:function(e){var t=e.split(new RegExp(o+s+"*")),r=t.slice(0,-1),i=t.slice(-1)[0],a={frames:r.map(function(e){return n.unmarshallSingle(e)}),partial:""};return i===s||-1!==i.search(RegExp(o+s+"*$"))?a.frames.push(n.unmarshallSingle(i)):a.partial=i,a}},{key:"marshall",value:function(e,t,r){return new n(e,t,r).toString()+o}}]),n}(),u=function(){function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,o);var r=n.binary,i=void 0!==r&&r,s=n.heartbeat,a=void 0===s?{outgoing:1e4,incoming:1e4}:s,c=n.debug,h=void 0===c||c;this.ws=t,this.ws.binaryType="arraybuffer",this.isBinary=!!i,this.hasDebug=!!h,this.connected=!1,this.heartbeat=a||{outgoing:0,incoming:0},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData=""}return t(o,[{key:"debug",value:function(){var e;this.hasDebug&&(e=console).log.apply(e,arguments)}},{key:"connect",value:function(){var e=this,t=this._parseConnect.apply(this,arguments),o=n(t,3),a=o[0],c=o[1],u=o[2];this.connectCallback=c,this.debug("Opening Web Socket..."),this.ws.onmessage=function(t){var n=t.data;if(t.data instanceof ArrayBuffer&&(n=function(e){var t=String.fromCharCode.apply(String,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e)).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n});return decodeURIComponent(t)}(new Uint8Array(t.data))),e.serverActivity=Date.now(),n!==s){e.debug("<<< "+n);var i=h.unmarshall(e.partialData+n);e.partialData=i.partial,i.frames.forEach(function(t){switch(t.command){case"CONNECTED":e.debug("connected to server "+t.headers.server),e.connected=!0,e.version=t.headers.version,e._setupHeartbeat(t.headers),c&&c(t);break;case"MESSAGE":var n=t.headers.subscription,i=e.subscriptions[n]||e.onreceive;if(i){var s=e.version===r.V1_2&&t.headers.ack||t.headers["message-id"];t.ack=e.ack.bind(e,s,n),t.nack=e.nack.bind(e,s,n),i(t)}else e.debug("Unhandled received MESSAGE: "+t);break;case"RECEIPT":e.onreceipt&&e.onreceipt(t);break;case"ERROR":u&&u(t);break;default:e.debug("Unhandled frame: "+t)}})}else e.debug("<<< PONG")},this.ws.onclose=function(t){e.debug("Whoops! Lost connection to "+e.ws.url+":",{event:t}),e._cleanUp(),u&&u(t)},this.ws.onopen=function(){e.debug("Web Socket Opened..."),a["accept-version"]=function(e){var t=i[e];return t||console.warn("DEPRECATED: "+e+" is not a recognized STOMP version. In next major client version, this will close the connection."),t||r.supportedVersions()}(e.ws.protocol),a["heart-beat"]||(a["heart-beat"]=[e.heartbeat.outgoing,e.heartbeat.incoming].join(",")),e._transmit("CONNECT",a)},this.ws.readyState===this.ws.OPEN&&this.ws.onopen()}},{key:"disconnect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._transmit("DISCONNECT",t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),e&&e()}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);r.destination=e,this._transmit("SEND",r,t)}},{key:"begin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tx-"+c();return this._transmit("BEGIN",{transaction:e}),{id:e,commit:this.commit.bind(this,e),abort:this.abort.bind(this,e)}}},{key:"commit",value:function(e){this._transmit("COMMIT",{transaction:e})}},{key:"abort",value:function(e){this._transmit("ABORT",{transaction:e})}},{key:"ack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.assign({},n);i[this.version===r.V1_2?"id":"message-id"]=e,i.subscription=t,this._transmit("ACK",i)}},{key:"nack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.assign({},n);i[this.version===r.V1_2?"id":"message-id"]=e,i.subscription=t,this._transmit("NACK",i)}},{key:"subscribe",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n);return r.id||(r.id="sub-"+c()),r.destination=e,this.subscriptions[r.id]=t,this._transmit("SUBSCRIBE",r),{id:r.id,unsubscribe:this.unsubscribe.bind(this,r.id)}}},{key:"unsubscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t);delete this.subscriptions[e],n.id=e,this._transmit("UNSUBSCRIBE",n)}},{key:"_cleanUp",value:function(){this.connected=!1,clearInterval(this.pinger),clearInterval(this.ponger)}},{key:"_transmit",value:function(e,t,n){var r=h.marshall(e,t,n);this.debug(">>> "+r,{frame:{command:e,headers:t,body:n}}),this._wsSend(r)}},{key:"_wsSend",value:function(e){for(this.isBinary&&(e=function(e){var t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}),n=Array.prototype.map.call(t,function(e){return e.charCodeAt(0)});return new Uint8Array(n)}(e)),this.debug(">>> length "+e.length);;){if(!(e.length>this.maxWebSocketFrameSize))return this.ws.send(e);this.ws.send(e.slice(0,this.maxWebSocketFrameSize)),e=e.slice(this.maxWebSocketFrameSize),this.debug("remaining = "+e.length)}}},{key:"_setupHeartbeat",value:function(e){var t=this;if(this.version===r.V1_1||this.version===r.V1_2){var i=(e["heart-beat"]||"0,0").split(",").map(function(e){return parseInt(e,10)}),o=n(i,2),a=o[0],c=o[1];if(0!==this.heartbeat.outgoing&&0!==c){var h=Math.max(this.heartbeat.outgoing,c);this.debug("send PING every "+h+"ms"),this.pinger=setInterval(function(){t._wsSend(s),t.debug(">>> PING")},h)}if(0!==this.heartbeat.incoming&&0!==a){var u=Math.max(this.heartbeat.incoming,a);this.debug("check PONG every "+u+"ms"),this.ponger=setInterval(function(){var e=Date.now()-t.serverActivity;e>2*u&&(t.debug("did not receive server activity for the last "+e+"ms"),t.ws.close())},u)}}}},{key:"_parseConnect",value:function(){for(var e={},t=void 0,n=void 0,r=arguments.length,i=Array(r),s=0;s<r;s++)i[s]=arguments[s];switch(i.length){case 2:e=i[0],t=i[1];break;case 3:i[1]instanceof Function?(e=i[0],t=i[1],n=i[2]):(e.login=i[0],e.passcode=i[1],t=i[2]);break;case 4:e.login=i[0],e.passcode=i[1],t=i[2],n=i[3];break;default:e.login=i[0],e.passcode=i[1],t=i[2],n=i[3],e.host=i[4]}return[e,t,n]}}]),o}();return{Frame:h,VERSIONS:r,client:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new WebSocket(e,t.protocols||r.supportedProtocols());return new u(n,t)},over:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(u,[null].concat(t)))}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.onConnecting=function(e,t){return"connecting to url "+e+" for identity "+t},e.prototype.onConnected=function(e,t){return"connected to url "+e+" for identity "+t},e.prototype.onDisconnecting=function(e,t){return"disconnecting from url "+e+" for identity "+t},e.prototype.onDisconnected=function(e,t){return"disconnected from url "+e+" for identity "+t},e.prototype.onReconnecting=function(e,t){return"reconnecting to url "+e+" for identity "+t},e.prototype.onError=function(e){return e},e.prototype.onMessage=function(e){return e},e}();t.Emitter=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),s=n(12),o=n(0);n(35),n(13),n(14);var a=function(e){function t(t){var n=e.call(this,name)||this;return n.name="BLOCK",n.message=t,n.position=t.position,n}return r(t,e),t.prototype.render=function(e,n){var r=this.position||"left",o=document.createElement("div");o.classList.add("block"),o.classList.add(r),o.appendChild(s.TextTime.render()),t.renderElements(o,this.message,n),e.appendChild(new i.TextIcon(r).render()),e.appendChild(o)},t}(o.MarkupComponent);t.Block=a},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,,,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);n(42);var s=function(e){function t(t){var n=e.call(this,name)||this;return n.name="BOLD",n.text=t.text,n}return r(t,e),t.prototype.render=function(e){var t=document.createElement("b");t.classList.add("bold"),t.appendChild(new i.InlineText(this.text).render()),e.appendChild(t)},t}(n(0).MarkupComponent);t.Bold=s},function(e,t,n){},,function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(0);n(45),n(13),n(14);var o=function(e){function t(t){var n=e.call(this,name)||this;return n.name="BUTTON",n.text=t.text,n.buttonName=t.name,n.value=t.value,n.position=t.position,n}return r(t,e),t.isNested=function(e){return e.hasClass("block")||"TD"===e.prop("tagName")},t.prototype.render=function(e,n){var r=this.position||"left",s=document.createElement("button");s.setAttribute("name",this.buttonName),t.isNested(e)?s.classList.add("button-nested",r):s.classList.add("button",r),s.appendChild(new i.InlineText(this.text).render()),e.appendChild(s);var o=this.text,a=this.buttonName,c=this.value;s.addEventListener("click",function(){n({type:"button",text:o,name:a,value:c})})},t}(s.MarkupComponent);t.Button=o},function(e,t,n){},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);n(48);var i=function(){function e(e){this.name="CHECKBOX",this.text=e.text,this.value=e.value,this.position=e.position}return e.prototype.render=function(e){var t=this.position||"left",n=document.createElement("input");n.classList.add("checkbox",t),n.setAttribute("type","checkbox"),n.setAttribute("name",this.name),n.appendChild(new r.InlineText(this.text).render()),e.appendChild(n)},e}();t.Checkbox=i},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);n(51);var s=function(e){function t(t){var n=e.call(this,name)||this;return n.name="COL",n.message=t,n}return r(t,e),t.prototype.render=function(e,n){var r=document.createElement("td");r.classList.add("col"),t.renderElements(r,this.message,n),e.appendChild(r)},t}(i.MarkupComponent);t.Col=s},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(0);n(54);var o=function(e){function t(t){var n=e.call(this,name)||this;return n.name="HEADLINE",n.message=t,n.text=t.text,n.position=t.position,n}return r(t,e),t.prototype.render=function(e){var t=this.position||"left",n=document.createElement("h2");n.classList.add("headline",t),n.appendChild(new i.InlineText(this.text).render()),e.appendChild(n)},t}(s.MarkupComponent);t.Headline=o},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);n(57);var s=function(e){function t(t){var n=e.call(this,name)||this;return n.name="IMAGE",n.source=t.source,n.text=t.text,n.width=t.width||"auto",n.height=t.height||"auto",n}return r(t,e),t.prototype.render=function(e){var t=document.createElement("img");t.setAttribute("src",this.source),t.setAttribute("alt",this.text),t.setAttribute("width",this.width),t.setAttribute("height",this.height),t.classList.add("image"),e.appendChild(t)},t}(i.MarkupComponent);t.Image=s},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(0);n(60);var o=function(e){function t(t){var n=e.call(this,name)||this;return n.name="ITEM",n.text=t.text,n}return r(t,e),t.prototype.render=function(e){var t=document.createElement("li");t.classList.add("item"),t.appendChild(new i.InlineText(this.text).render()),e.appendChild(t)},t}(s.MarkupComponent);t.Item=o},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);n(63);var s=function(e){function t(t){var n=e.call(this,name)||this;return n.name="ITEMS",n.elements=t.elements,n}return r(t,e),t.prototype.render=function(e,n){var r=document.createElement("ul");r.classList.add("items"),t.renderElements(r,this.elements,n),e.appendChild(r)},t}(i.MarkupComponent);t.Items=s},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(0);n(66);var o=function(e){function t(t){var n=e.call(this,name)||this;return n.name="LINK",n.text=t.text,n.value=t.value,n}return r(t,e),t.prototype.render=function(e){var t=document.createElement("a");t.setAttribute("href",this.value),t.classList.add("link"),t.appendChild(new i.InlineText(this.text).render()),e.appendChild(t)},t}(s.MarkupComponent);t.Link=o},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);n(69);var s=function(e){function t(t){var n=e.call(this,name)||this;return n.name="ROW",n.message=t,n}return r(t,e),t.prototype.render=function(e,n){var r=document.createElement("tr");r.classList.add("row"),t.renderElements(r,this.message,n),e.appendChild(r)},t}(i.MarkupComponent);t.Row=s},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(0);n(13),n(14),n(72);var o=function(e){function t(t){var n=e.call(this,name)||this;return n.name="SUBMIT",n.text=t.text,n.position=t.position,n.timestamp=t.timestamp,n}return r(t,e),t.closestByClass=function(e,t){for(;e.className!=t;)if(!(e=e.parentNode))return null;return e},t.prototype.render=function(e,n){var r=this.position||"left",s=document.createElement("button");t.isNested(e)?s.classList.add("submit-nested",r):s.classList.add("submit",r),s.appendChild(new i.InlineText(this.text).render()),e.appendChild(s);var o=this.text,a=this.timestamp;s.addEventListener("click",function(e){return function(){var r={};t.closestByClass(e,"message-content").querySelectorAll("input[type='checkbox']").forEach(function(e,t){if(!0===t.checked){var n=t.getAttribute("name"),i=t.getAttribute("value");void 0!==r[n]?r[n].push(i):r[n]=[i]}}),n({type:"submit",position:"right",timestamp:a,text:o,attributes:r})}})},t}(s.MarkupComponent);t.Submit=o},function(e,t,n){},,function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),s=n(12),o=function(e){function t(t){var n=e.call(this,name)||this;return n.name="TABLE",n.message=t,n.position=t.position,n}return r(t,e),t.prototype.render=function(e,n){var r=document.createElement("table");if(t.isNested(e))r.classList.add("table-nested"),t.renderElements(r,this.message,n);else{var o=this.position||"left";r.classList.add("table",o),r.appendChild(s.TextTime.render()),t.renderElements(r,this.message,n),e.appendChild(new i.TextIcon(o).render())}e.appendChild(r)},t}(n(0).MarkupComponent);t.Table=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(11),o=n(12),a=function(e){function t(t){var n=e.call(this,name)||this;return n.name="TEXT",n.text=t.text,n.position=t.position,n}return r(t,e),t.isNested=function(e){return e.hasClass("block")||"TD"===e.prop("tagName")},t.prototype.render=function(e){if(t.isNested(e))e.appendChild(new i.InlineText(this.text).render());else{var n=this.position||"left",r=document.createElement("div");r.classList.add("text",n),r.appendChild(o.TextTime.render()),r.appendChild(new i.InlineText(this.text).render()),e.appendChild(new s.TextIcon(n).render()),e.appendChild(r)}},t}(n(0).MarkupComponent);t.Text=a},function(e,t,n){e.exports=n(77)},function(e,t,n){(function(e){(function(){var r,i,s,o,a,c,h,u,p,d,f,l,_,v,y,g,m=function(e,t){for(var n in t)b.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},b={}.hasOwnProperty,E=function(e,t){return function(){return e.apply(t,arguments)}};a=n(19),c=n(20),g=n(78),y=n(2),_=n(81),l=n(105),v=n(106),u=n(107),d=n(108),f=n(109),o=n(110),p=function(){var t;try{t=c.readFileSync(e+"/../package.json","utf-8")}catch(e){}return t?JSON.parse(t).version:null},r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return m(t,e),t.prototype.welcome_screen=function(e,t){return t.setHeader("content-type","text/plain; charset=UTF-8"),t.writeHead(200),t.end("Welcome to SockJS!\n"),!0},t.prototype.handle_404=function(e,t){return t.setHeader("content-type","text/plain; charset=UTF-8"),t.writeHead(404),t.end("404 Error: Page not found\n"),!0},t.prototype.disabled_transport=function(e,t,n){return this.handle_404(e,t,n)},t.prototype.h_sid=function(e,t,n){var r;return e.cookies=y.parseCookie(e.headers.cookie),"function"==typeof this.options.jsessionid?this.options.jsessionid(e,t):this.options.jsessionid&&t.setHeader&&(r=e.cookies.JSESSIONID||"dummy",t.setHeader("Set-Cookie","JSESSIONID="+r+"; path=/")),n},t.prototype.log=function(e,t){return this.options.log(e,t)},t}(g.GenericApp),y.objectExtend(r.prototype,u.app),y.objectExtend(r.prototype,o.app),y.objectExtend(r.prototype,_.app),y.objectExtend(r.prototype,l.app),y.objectExtend(r.prototype,v.app),y.objectExtend(r.prototype,d.app),y.objectExtend(r.prototype,f.app),h=function(e){var t,n,r,i,s;return i=function(e){return[n("/([^/.]+)/([^/.]+)"+e),"server","session"]},t=function(e){return null==e&&(e="xhr_options"),["h_sid","xhr_cors","cache_for",e,"expose"]},r=[["GET",(n=function(t){return new RegExp("^"+e.prefix+t+"[/]?$")})(""),["welcome_screen"]],["GET",n("/iframe[0-9-.a-z_]*.html"),["iframe","cache_for","expose"]],["OPTIONS",n("/info"),t("info_options")],["GET",n("/info"),["xhr_cors","h_no_cache","info","expose"]],["OPTIONS",n("/chunking_test"),t()],["POST",n("/chunking_test"),["xhr_cors","expect_xhr","chunking_test"]]],s=[["GET",i("/jsonp"),["h_sid","h_no_cache","jsonp"]],["POST",i("/jsonp_send"),["h_sid","h_no_cache","expect_form","jsonp_send"]],["POST",i("/xhr"),["h_sid","h_no_cache","xhr_cors","xhr_poll"]],["OPTIONS",i("/xhr"),t()],["POST",i("/xhr_send"),["h_sid","h_no_cache","xhr_cors","expect_xhr","xhr_send"]],["OPTIONS",i("/xhr_send"),t()],["POST",i("/xhr_streaming"),["h_sid","h_no_cache","xhr_cors","xhr_streaming"]],["OPTIONS",i("/xhr_streaming"),t()],["GET",i("/eventsource"),["h_sid","h_no_cache","eventsource"]],["GET",i("/htmlfile"),["h_sid","h_no_cache","htmlfile"]]],e.websocket?(r.push(["GET",n("/websocket"),["raw_websocket"]]),s.push(["GET",i("/websocket"),["sockjs_websocket"]])):(r.push(["GET",n("/websocket"),["cache_for","disabled_transport"]]),s.push(["GET",i("/websocket"),["cache_for","disabled_transport"]])),r.concat(s)},i=function(){function e(e,t){this.options=e,this.handler=E(this.handler,this),this.app=new r,this.app.options=this.options,this.app.emit=t,this.app.log("debug","SockJS v"+p()+" bound to "+JSON.stringify(this.options.prefix)),this.dispatcher=h(this.options),this.webjs_handler=g.generateHandler(this.app,this.dispatcher),this.path_regexp=new RegExp("^"+this.options.prefix+"([/].+|[/]?)$")}return e.prototype.handler=function(e,t,n){return!!e.url.match(this.path_regexp)&&(this.webjs_handler(e,t,n),!0)},e.prototype.getHandler=function(){return function(e){return function(t,n,r){return e.handler(t,n,r)}}(this)},e}(),s=function(e){function t(e){this.options={prefix:"",response_limit:131072,websocket:!0,faye_server_options:null,jsessionid:!1,heartbeat_delay:25e3,disconnect_delay:5e3,log:function(e,t){return console.log(t)},sockjs_url:"https://cdn.jsdelivr.net/sockjs/1/sockjs.min.js"},e&&y.objectExtend(this.options,e)}return m(t,e),t.prototype.listener=function(e){var t;return t=y.objectExtend({},this.options),e&&y.objectExtend(t,e),new i(t,function(e){return function(){return e.emit.apply(e,arguments)}}(this))},t.prototype.installHandlers=function(e,t){var n;return n=this.listener(t).getHandler(),y.overshadowListeners(e,"request",n),y.overshadowListeners(e,"upgrade",n),!0},t.prototype.middleware=function(e){var t;return(t=this.listener(e).getHandler()).upgrade=t,t},t}(a.EventEmitter),t.createServer=function(e){return new s(e)},t.listen=function(e,n){var r;return r=t.createServer(n),e&&r.installHandlers(e),r}}).call(this)}).call(this,"/")},function(e,t,n){(function(){var e,r,i,s,o,a,c;a=n(8),o=n(79),i=n(20),s=n(80),c=n(2),e=function(e,t,n,r,i){var s,o,a;try{for(o=[];t.length>0;)s=t.shift(),n.last_fun=s,o.push(i=e[s](n,r,i,n.next_filter));return o}catch(t){if("object"==typeof(a=t)&&"status"in a){if(0===a.status)return;"handle_"+a.status in e?e["handle_"+a.status](n,r,a):e.handle_error(n,r,a)}else e.handle_error(n,r,a);return e.log_request(n,r,!0)}},r=function(e,t){var n;return n={Connection:"close"},t.writeHead=function(r,i){var o,a;for(o in null==i&&(i={}),(a=[]).push("HTTP/"+e.httpVersion+" "+r+" "+s.STATUS_CODES[r]),c.objectExtend(n,i),n)a.push(o+": "+n[o]);a=a.concat(["",""]);try{t.write(a.join("\r\n"))}catch(e){}try{return t.end()}catch(e){}},t.setHeader=function(e,t){return n[e]=t}},t.generateHandler=function(t,n){return function(i,s,o){var h,u,p,d,f,l,_,v,y,g,m,b;for(void 0===s.writeHead&&r(i,s),c.objectExtend(i,a.parse(i.url,!0)),i.start_date=new Date,u=!1,h=[],f=0,_=n.length;f<_;f++)if(y=(b=n[f])[0],g=b[1],p=b[2],g.constructor!==Array&&(g=[g]),v=i.pathname.match(g[0])){if(i.method.match(new RegExp(y))){for(d=l=1,m=g.length;1<=m?l<m:l>m;d=1<=m?++l:--l)i[g[d]]=v[d];(p=p.slice(0)).push("log_request"),i.next_filter=function(n){return e(t,p,i,s,n)},i.next_filter(o),u=!0;break}h.push(y)}u||(0!==h.length?t.handle_405(i,s,h):t.handle_404(i,s),t.log_request(i,s,!0))}},t.GenericApp=function(){function e(){}return e.prototype.handle_404=function(e,t,n){return t.finished?n:(t.writeHead(404,{}),t.end(),!0)},e.prototype.handle_405=function(e,t,n){return t.writeHead(405,{Allow:n.join(", ")}),t.end(),!0},e.prototype.handle_error=function(e,t,n){if(t.finished)return n;if("object"==typeof n&&"status"in n)t.writeHead(n.status,{}),t.end(n.message||"");else{try{t.writeHead(500,{}),t.end("500 - Internal Server Error")}catch(e){n=e}this.log("error",'Exception on "'+e.method+" "+e.href+'" in filter "'+e.last_fun+'":\n'+(n.stack||n))}return!0},e.prototype.log_request=function(e,t,n){var r;return r=new Date-e.start_date,this.log("info",e.method+" "+e.url+" "+r+"ms "+(t.finished?t.statusCode:"(unfinished)")),n},e.prototype.log=function(e,t){return console.log(t)},e.prototype.expose_html=function(e,t,n){return t.finished?n:(t.getHeader("Content-Type")||t.setHeader("Content-Type","text/html; charset=UTF-8"),this.expose(e,t,n))},e.prototype.expose_json=function(e,t,n){return t.finished?n:(t.getHeader("Content-Type")||t.setHeader("Content-Type","application/json"),this.expose(e,t,JSON.stringify(n)))},e.prototype.expose=function(e,t,n){return t.finished?n:(n&&!t.getHeader("Content-Type")&&t.setHeader("Content-Type","text/plain"),n&&t.setHeader("Content-Length",n.length),t.writeHead(t.statusCode),t.end(n,"utf8"),!0)},e.prototype.serve_file=function(e,t,n,r){var s;throw s=function(e,n){return e?(t.writeHead(500),t.end("can't read file")):(t.setHeader("Content-length",n.length),t.writeHead(t.statusCode,t.headers),t.end(n,"utf8")),r(!0)},i.readFile(n,s),{status:0}},e.prototype.cache_for=function(e,t,n){var r;return t.cache_for=t.cache_for||31536e3,t.setHeader("Cache-Control","public, max-age="+t.cache_for),(r=new Date).setTime(r.getTime()+1e3*t.cache_for),t.setHeader("Expires",r.toGMTString()),n},e.prototype.h_no_cache=function(e,t,n){return t.setHeader("Cache-Control","no-store, no-cache, no-transform, must-revalidate, max-age=0"),n},e.prototype.expect_form=function(e,t,n,r){var i;throw i=new Buffer(0),e.on("data",function(e){return i=c.buffer_concat(i,new Buffer(e,"binary"))}),e.on("end",function(t){return function(){var n;switch(i=i.toString("utf-8"),(e.headers["content-type"]||"").split(";")[0]){case"application/x-www-form-urlencoded":n=o.parse(i);break;case"text/plain":case"":n=i;break;default:t.log("error","Unsupported content-type "+e.headers["content-type"]),n=void 0}return r(n)}}(this)),{status:0}},e.prototype.expect_xhr=function(e,t,n,r){var i;throw i=new Buffer(0),e.on("data",function(e){return i=c.buffer_concat(i,new Buffer(e,"binary"))}),e.on("end",function(t){return function(){var n;switch(i=i.toString("utf-8"),(e.headers["content-type"]||"").split(";")[0]){case"text/plain":case"T":case"application/json":case"application/xml":case"":case"text/xml":n=i;break;default:t.log("error","Unsupported content-type "+e.headers["content-type"]),n=void 0}return r(n)}}(this)),{status:0}},e}()}).call(this)},function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("http")},function(e,t,n){(function(){var e,r,i,s,o,a=function(e,t){for(var n in t)c.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},c={}.hasOwnProperty;e=n(82),n(2),o=n(7),t.app={_websocket_check:function(t,n,r){if(!e.isWebSocket(t))throw{status:400,message:"Not a valid websocket request"}},sockjs_websocket:function(t,n,r){var i;return this._websocket_check(t,n,r),(i=new e(t,n,r,null,this.options.faye_server_options)).onopen=function(e){return function(){return o.registerNoSession(t,e,new s(i,n))}}(this),!0},raw_websocket:function(t,n,i){var s,o;if(this._websocket_check(t,n,i),s=t.headers["sec-websocket-version"]||"",-1===["8","13"].indexOf(s))throw{status:400,message:"Only supported WebSocket protocol is RFC 6455."};return(o=new e(t,n,i,null,this.options.faye_server_options)).onopen=function(e){return function(){return new r(t,n,e,o)}}(this),!0}},s=function(e){function t(e,n){this.ws=e,this.connection=n;try{this.connection.setKeepAlive(!0,5e3),this.connection.setNoDelay(!0)}catch(e){}this.ws.addEventListener("message",function(e){return function(t){return e.didMessage(t.data)}}(this)),this.heartbeat_cb=function(e){return function(){return e.heartbeat_timeout()}}(this),t.__super__.constructor.call(this,this.connection)}return a(t,e),t.prototype.protocol="websocket",t.prototype.setUp=function(){return t.__super__.setUp.apply(this,arguments),this.ws.addEventListener("close",this.thingy_end_cb)},t.prototype.tearDown=function(){return this.ws.removeEventListener("close",this.thingy_end_cb),t.__super__.tearDown.apply(this,arguments)},t.prototype.didMessage=function(e){var t,n,r,i,s;if(this.ws&&this.session&&e.length>0){try{r=JSON.parse(e)}catch(e){return this.didClose(3e3,"Broken framing.")}if("["===e[0]){for(s=[],t=0,n=r.length;t<n;t++)i=r[t],s.push(this.session.didMessage(i));return s}return this.session.didMessage(r)}},t.prototype.doSendFrame=function(e){if(this.ws)try{return this.ws.send(e),!0}catch(e){}return!1},t.prototype.didClose=function(e,n){null==e&&(e=1e3),null==n&&(n="Normal closure"),t.__super__.didClose.apply(this,arguments);try{this.ws.close(e,n,!1)}catch(e){}return this.ws=null,this.connection=null},t.prototype.heartbeat=function(){var e;return this.ws.ping(null,function(){return clearTimeout(e)})?e=setTimeout(this.heartbeat_cb,1e4):t.__super__.heartbeat.apply(this,arguments)},t.prototype.heartbeat_timeout=function(){if(null!=this.session)return this.session.close(3e3,"No response from heartbeat")},t}(o.GenericReceiver),i=o.Transport,r=function(e){function t(e,t,n,r){this.ws=r,this.prefix=n.options.prefix,this.readyState=i.OPEN,this.recv={connection:t,protocol:"websocket-raw"},this.connection=new o.SockJSConnection(this),this.decorateConnection(e),n.emit("connection",this.connection),this._end_cb=function(e){return function(){return e.didClose()}}(this),this.ws.addEventListener("close",this._end_cb),this._message_cb=function(e){return function(t){return e.didMessage(t)}}(this),this.ws.addEventListener("message",this._message_cb)}return a(t,e),t.prototype.didMessage=function(e){this.readyState===i.OPEN&&this.connection.emit("data",e.data)},t.prototype.send=function(e){return this.readyState===i.OPEN&&(this.ws.send(e),!0)},t.prototype.close=function(e,t){return null==e&&(e=1e3),null==t&&(t="Normal closure"),this.readyState===i.OPEN&&(this.readyState=i.CLOSING,this.ws.close(e,t,!1),!0)},t.prototype.didClose=function(){if(this.ws){this.ws.removeEventListener("message",this._message_cb),this.ws.removeEventListener("close",this._end_cb);try{this.ws.close(1e3,"Normal closure",!1)}catch(e){}return this.ws=null,this.readyState=i.CLOSED,this.connection.emit("end"),this.connection.emit("close"),this.connection=null}},t}(o.Session)}).call(this)},function(e,t,n){var r=n(1),i=n(9),s=n(17),o=function(e,t,n,r,o){o=o||{},this._stream=t,this._driver=i.http(e,{maxLength:o.maxLength,protocols:r});var a=this;if(this._stream&&this._stream.writable){if(!this._stream.readable)return this._stream.end();var c=function(){a._stream.removeListener("data",c)};this._stream.on("data",c),s.call(this,o),process.nextTick(function(){a._driver.start(),a._driver.io.write(n)})}};r.inherits(o,s),o.isWebSocket=function(e){return i.isWebSocket(e)},o.validateOptions=function(e,t){i.validateOptions(e,t)},o.WebSocket=o,o.Client=n(98),o.EventSource=n(101),e.exports=o},function(e,t,n){"use strict";var r=n(6).Stream,i=n(1),s=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};i.inherits(s,r),s.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0},s.prototype.resume=function(){this._paused=!1,this.emit("drain");var e=this._driver.messages;e._paused=!1,e.emit("drain")},s.prototype.write=function(e){return!!this.writable&&(this._driver.parse(e),!this._paused)},s.prototype.end=function(e){if(this.writable){void 0!==e&&this.write(e),this.writable=!1;var t=this._driver.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))}},s.prototype.destroy=function(){this.end()};var o=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};i.inherits(o,r),o.prototype.pause=function(){this._driver.io._paused=!0},o.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")},o.prototype.write=function(e){return!!this.writable&&("string"==typeof e?this._driver.text(e):this._driver.binary(e),!this._paused)},o.prototype.end=function(e){void 0!==e&&this.write(e)},o.prototype.destroy=function(){},t.IO=s,t.Messages=o},function(e,t,n){"use strict";var r=function(){this._queue=[],this._queueSize=0,this._offset=0};r.prototype.put=function(e){e&&0!==e.length&&(e.copy||(e=new Buffer(e)),this._queue.push(e),this._queueSize+=e.length)},r.prototype.read=function(e){if(e>this._queueSize)return null;if(0===e)return new Buffer(0);this._queueSize-=e;var t,n,r=this._queue,i=e,s=r[0];if(s.length>=e)return s.length===e?r.shift():(n=s.slice(0,e),r[0]=s.slice(e),n);for(var o=0,a=r.length;o<a&&!(i<r[o].length);o++)i-=r[o].length;return t=r.splice(0,o),i>0&&r.length>0&&(t.push(r[0].slice(0,i)),r[0]=r[0].slice(i)),this._concat(t,e)},r.prototype.eachByte=function(e,t){for(var n,r,i;this._queue.length>0;){for(r=(n=this._queue[0]).length;this._offset<r;)i=this._offset,this._offset+=1,e.call(t,n[i]);this._offset=0,this._queue.shift()}},r.prototype._concat=function(e,t){if(Buffer.concat)return Buffer.concat(e,t);for(var n=new Buffer(t),r=0,i=0,s=e.length;i<s;i++)e[i].copy(n,r),r+=e[i].length;return n},e.exports=r},function(e,t,n){"use strict";var r=n(5),i=n(8),s=n(1),o=n(16),a=n(4),c=n(21),h=n(95),u=function(e,t){this.version="hybi-13",c.call(this,null,e,t),this.readyState=-1,this._key=u.generateKey(),this._accept=c.generateAccept(this._key),this._http=new o("response");var n=i.parse(this.url),r=n.auth&&new Buffer(n.auth,"utf8").toString("base64");if(this.VALID_PROTOCOLS.indexOf(n.protocol)<0)throw new Error(this.url+" is not a valid WebSocket URL");this._pathname=(n.pathname||"/")+(n.search||""),this._headers.set("Host",n.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version","13"),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),r&&this._headers.set("Authorization","Basic "+r)};s.inherits(u,c),u.generateKey=function(){return r.randomBytes(16).toString("base64")};var p={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(e,t){return new h(this,e,t)},start:function(){return-1===this.readyState&&(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(e){if(3!==this.readyState){if(this.readyState>0)return c.prototype.parse.call(this,e);this._http.parse(e),this._http.isComplete()&&(this._validateHandshake(),3!==this.readyState&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var e=this._extensions.generateOffer();e&&this._headers.set("Sec-WebSocket-Extensions",e);var t=["GET "+this._pathname+" HTTP/1.1",this._headers.toString(),""];return new Buffer(t.join("\r\n"),"utf8")},_failHandshake:function(e){e="Error during WebSocket handshake: "+e,this.readyState=3,this.emit("error",new Error(e)),this.emit("close",new a.CloseEvent(this.ERRORS.protocol_error,e))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(101!==this._http.statusCode)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var e=this._http.headers,t=e.upgrade||"",n=e.connection||"",r=e["sec-websocket-accept"]||"",i=e["sec-websocket-protocol"]||"";if(""===t)return this._failHandshake("'Upgrade' header is missing");if("websocket"!==t.toLowerCase())return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(""===n)return this._failHandshake("'Connection' header is missing");if("upgrade"!==n.toLowerCase())return this._failHandshake("'Connection' header value is not 'Upgrade'");if(r!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,""!==i){if(this._protocols.indexOf(i)<0)return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=i}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(e){return this._failHandshake(e.message)}}};for(var d in p)u.prototype[d]=p[d];e.exports=u},function(e,t,n){var r=n(87);function i(e){r.ok(e===i.REQUEST||e===i.RESPONSE),this.type=e,this.state=e+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1}t.HTTPParser=i,i.encoding="ascii",i.maxHeaderSize=81920,i.REQUEST="REQUEST",i.RESPONSE="RESPONSE";var s=i.kOnHeaders=0,o=i.kOnHeadersComplete=1,a=i.kOnBody=2,c=i.kOnMessageComplete=3;i.prototype[s]=i.prototype[o]=i.prototype[a]=i.prototype[c]=function(){};var h=!0;Object.defineProperty(i,"kOnExecute",{get:function(){return h=!1,4}});var u=t.methods=i.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK"],p=u.indexOf("CONNECT");i.prototype.reinitialize=i,i.prototype.close=i.prototype.pause=i.prototype.resume=i.prototype.free=function(){},i.prototype._compatMode0_11=!1,i.prototype.getAsyncId=function(){return 0};var d={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};i.prototype.execute=function(e,t,n){if(!(this instanceof i))throw new TypeError("not a HTTPParser");t=t||0,n="number"==typeof n?n:e.length,this.chunk=e,this.offset=t;var r=this.end=t+n;try{for(;this.offset<r&&!this[this.state](););}catch(e){if(this.isUserCall)throw e;return this.hadError=!0,e}return this.chunk=null,n=this.offset-t,d[this.state]&&(this.headerSize+=n,this.headerSize>i.maxHeaderSize)?new Error("max header size exceeded"):n};var f={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};i.prototype.finish=function(){if(!this.hadError)return f[this.state]?void("BODY_RAW"===this.state&&this.userCall()(this[c]())):new Error("invalid state for EOF")},i.prototype.consume=i.prototype.unconsume=i.prototype.getCurrentBuffer=function(){},i.prototype.userCall=function(){this.isUserCall=!0;var e=this;return function(t){return e.isUserCall=!1,t}},i.prototype.nextRequest=function(){this.userCall()(this[c]()),this.reinitialize(this.type)},i.prototype.consumeLine=function(){for(var e=this.end,t=this.chunk,n=this.offset;n<e;n++)if(10===t[n]){var r=this.line+t.toString(i.encoding,this.offset,n);return"\r"===r.charAt(r.length-1)&&(r=r.substr(0,r.length-1)),this.line="",this.offset=n+1,r}this.line+=t.toString(i.encoding,this.offset,this.end),this.offset=this.end};var l=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,_=/^[ \t]+(.*[^ \t])/;i.prototype.parseHeader=function(e,t){if(-1!==e.indexOf("\r"))throw g("HPE_LF_EXPECTED");var n=l.exec(e),r=n&&n[1];if(r)t.push(r),t.push(n[2]);else{var i=_.exec(e);i&&t.length&&(t[t.length-1]&&(t[t.length-1]+=" "),t[t.length-1]+=i[1])}};var v=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;i.prototype.REQUEST_LINE=function(){var e=this.consumeLine();if(e){var t=v.exec(e);if(null===t)throw g("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?t[1]:u.indexOf(t[1]),-1===this.info.method)throw new Error("invalid request method");this.info.url=t[2],this.info.versionMajor=+t[3],this.info.versionMinor=+t[4],this.body_bytes=0,this.state="HEADER"}};var y=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;function g(e){var t=new Error("Parse Error");return t.code=e,t}i.prototype.RESPONSE_LINE=function(){var e=this.consumeLine();if(e){var t=y.exec(e);if(null===t)throw g("HPE_INVALID_CONSTANT");this.info.versionMajor=+t[1],this.info.versionMinor=+t[2];var n=this.info.statusCode=+t[3];this.info.statusMessage=t[4],1!=(n/100|0)&&204!==n&&304!==n||(this.body_bytes=0),this.state="HEADER"}},i.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(-1!==this.connection.indexOf("close"))return!1}else if(-1===this.connection.indexOf("keep-alive"))return!1;return!(null===this.body_bytes&&!this.isChunked)},i.prototype.HEADER=function(){var e=this.consumeLine();if(void 0!==e){var t=this.info;if(e)this.parseHeader(e,t.headers);else{for(var n,r,s=t.headers,a=!1,c=!1,u=0;u<s.length;u+=2)switch(s[u].toLowerCase()){case"transfer-encoding":this.isChunked="chunked"===s[u+1].toLowerCase();break;case"content-length":if(n=+s[u+1],a){if(n!==this.body_bytes)throw g("HPE_UNEXPECTED_CONTENT_LENGTH")}else a=!0,this.body_bytes=n;break;case"connection":this.connection+=s[u+1].toLowerCase();break;case"upgrade":c=!0}if(this.isChunked&&a&&(this.isChunked=!1),c&&-1!=this.connection.indexOf("upgrade")?t.upgrade=this.type===i.REQUEST||101===t.statusCode:t.upgrade=t.method===p,t.shouldKeepAlive=this.shouldKeepAlive(),2===(r=h?this.userCall()(this[o](t)):this.userCall()(this[o](t.versionMajor,t.versionMinor,t.headers,t.method,t.url,t.statusCode,t.statusMessage,t.upgrade,t.shouldKeepAlive))))return this.nextRequest(),!0;if(this.isChunked&&!r)this.state="BODY_CHUNKHEAD";else{if(r||0===this.body_bytes)return this.nextRequest(),t.upgrade;null===this.body_bytes?this.state="BODY_RAW":this.state="BODY_SIZED"}}}},i.prototype.BODY_CHUNKHEAD=function(){var e=this.consumeLine();void 0!==e&&(this.body_bytes=parseInt(e,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")},i.prototype.BODY_CHUNK=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[a](this.chunk,this.offset,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")},i.prototype.BODY_CHUNKEMPTYLINE=function(){var e=this.consumeLine();void 0!==e&&(r.equal(e,""),this.state="BODY_CHUNKHEAD")},i.prototype.BODY_CHUNKTRAILERS=function(){var e=this.consumeLine();void 0!==e&&(e?this.parseHeader(e,this.trailers):(this.trailers.length&&this.userCall()(this[s](this.trailers,"")),this.nextRequest()))},i.prototype.BODY_RAW=function(){var e=this.end-this.offset;this.userCall()(this[a](this.chunk,this.offset,e)),this.offset=this.end},i.prototype.BODY_SIZED=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[a](this.chunk,this.offset,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||this.nextRequest()},["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(e){var t=i["kOn"+e];Object.defineProperty(i.prototype,"on"+e,{get:function(){return this[t]},set:function(e){return this._compatMode0_11=!0,p="CONNECT",this[t]=e}})})},function(e,t){e.exports=require("assert")},function(e,t,n){"use strict";var r=n(89),i=n(90),s=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};s.MESSAGE_OPCODES=[1,2];var o={add:function(e){if("string"!=typeof e.name)throw new TypeError("extension.name must be a string");if("permessage"!==e.type)throw new TypeError('extension.type must be "permessage"');if("boolean"!=typeof e.rsv1)throw new TypeError("extension.rsv1 must be true or false");if("boolean"!=typeof e.rsv2)throw new TypeError("extension.rsv2 must be true or false");if("boolean"!=typeof e.rsv3)throw new TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(e.name))throw new TypeError('An extension with name "'+e.name+'" is already registered');this._byName[e.name]=e,this._inOrder.push(e)},generateOffer:function(){var e=[],t=[],n={};return this._inOrder.forEach(function(i){var s=i.createClientSession();if(s){var o=[i,s];e.push(o),n[i.name]=o;var a=s.generateOffer();(a=a?[].concat(a):[]).forEach(function(e){t.push(r.serializeParams(i.name,e))},this)}},this),this._sessions=e,this._index=n,t.length>0?t.join(", "):null},activate:function(e){var t=[];r.parseHeader(e).eachOffer(function(e,n){var i=this._index[e];if(!i)throw new Error('Server sent an extension response for unknown extension "'+e+'"');var s=i[0],o=i[1],a=this._reserved(s);if(a)throw new Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+s.name+'"');if(!0!==o.activate(n))throw new Error("Server sent unacceptable extension parameters: "+r.serializeParams(e,n));this._reserve(s),t.push(i)},this),this._sessions=t,this._pipeline=new i(t)},generateResponse:function(e){var t=[],n=[],s=r.parseHeader(e);return this._inOrder.forEach(function(e){var i=s.byName(e.name);if(0!==i.length&&!this._reserved(e)){var o=e.createServerSession(i);o&&(this._reserve(e),t.push([e,o]),n.push(r.serializeParams(e.name,o.generateResponse())))}},this),this._sessions=t,this._pipeline=new i(t),n.length>0?n.join(", "):null},validFrameRsv:function(e){var t,n={rsv1:!1,rsv2:!1,rsv3:!1};if(s.MESSAGE_OPCODES.indexOf(e.opcode)>=0)for(var r=0,i=this._sessions.length;r<i;r++)t=this._sessions[r][0],n.rsv1=n.rsv1||t.rsv1,n.rsv2=n.rsv2||t.rsv2,n.rsv3=n.rsv3||t.rsv3;return(n.rsv1||!e.rsv1)&&(n.rsv2||!e.rsv2)&&(n.rsv3||!e.rsv3)},processIncomingMessage:function(e,t,n){this._pipeline.processIncomingMessage(e,t,n)},processOutgoingMessage:function(e,t,n){this._pipeline.processOutgoingMessage(e,t,n)},close:function(e,t){if(!this._pipeline)return e.call(t);this._pipeline.close(e,t)},_reserve:function(e){this._rsv1=this._rsv1||e.rsv1&&e.name,this._rsv2=this._rsv2||e.rsv2&&e.name,this._rsv3=this._rsv3||e.rsv3&&e.name},_reserved:function(e){return this._rsv1&&e.rsv1?[1,this._rsv1]:this._rsv2&&e.rsv2?[2,this._rsv2]:!(!this._rsv3||!e.rsv3)&&[3,this._rsv3]}};for(var a in o)s.prototype[a]=o[a];e.exports=s},function(e,t,n){"use strict";var r=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,i=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,s=new RegExp(r.source+"(?:=(?:"+r.source+"|"+/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"])*)"/.source+"))?"),o=new RegExp(r.source+"(?: *; *"+s.source+")*","g"),a=new RegExp("^"+o.source+"(?: *, *"+o.source+")*$"),c=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,h=Object.prototype.hasOwnProperty,u={parseHeader:function(e){var t=new p;if(""===e||void 0===e)return t;if(!a.test(e))throw new SyntaxError("Invalid Sec-WebSocket-Extensions header: "+e);return e.match(o).forEach(function(e){var n=e.match(new RegExp(s.source,"g")),r=n.shift(),i={};n.forEach(function(e){var t,n=e.match(s),r=n[1];t=void 0!==n[2]?n[2]:void 0===n[3]||n[3].replace(/\\/g,""),c.test(t)&&(t=parseFloat(t)),h.call(i,r)?(i[r]=[].concat(i[r]),i[r].push(t)):i[r]=t},this),t.push(r,i)},this),t},serializeParams:function(e,t){var n=[],r=function(e,t){t instanceof Array?t.forEach(function(t){r(e,t)}):!0===t?n.push(e):"number"==typeof t?n.push(e+"="+t):i.test(t)?n.push(e+'="'+t.replace(/"/g,'\\"')+'"'):n.push(e+"="+t)};for(var s in t)r(s,t[s]);return[e].concat(n).join("; ")}},p=function(){this._byName={},this._inOrder=[]};p.prototype.push=function(e,t){h.call(this._byName,e)||(this._byName[e]=[]),this._byName[e].push(t),this._inOrder.push({name:e,params:t})},p.prototype.eachOffer=function(e,t){for(var n=this._inOrder,r=0,i=n.length;r<i;r++)e.call(t,n[r].name,n[r].params)},p.prototype.byName=function(e){return this._byName[e]||[]},p.prototype.toArray=function(){return this._inOrder.slice()},e.exports=u},function(e,t,n){"use strict";var r=n(91),i=n(23),s=function(e){this._cells=e.map(function(e){return new r(e)}),this._stopped={incoming:!1,outgoing:!1}};s.prototype.processIncomingMessage=function(e,t,n){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,e,t,n)},s.prototype.processOutgoingMessage=function(e,t,n){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,e,t,n)},s.prototype.close=function(e,t){this._stopped={incoming:!0,outgoing:!0};var n=this._cells.map(function(e){return e.close()});e&&i.all(n).then(function(){e.call(t)})},s.prototype._loop=function(e,t,n,r,i,s,o){for(var a=this._cells,c=a.length,h=this;c--;)a[c].pending(e);var u=function(t,i,c){if(t===n)return s.call(o,i,c);a[t][e](i,c,function(n,i){n&&(h._stopped[e]=!0),u(t+r,n,i)})};u(t,null,i)},e.exports=s},function(e,t,n){"use strict";var r=n(92),i=n(23),s=function(e){this._ext=e[0],this._session=e[1],this._functors={incoming:new r(this._session,"processIncomingMessage"),outgoing:new r(this._session,"processOutgoingMessage")}};s.prototype.pending=function(e){var t=this._functors[e];t._stopped||(t.pending+=1)},s.prototype.incoming=function(e,t,n,r){this._exec("incoming",e,t,n,r)},s.prototype.outgoing=function(e,t,n,r){this._exec("outgoing",e,t,n,r)},s.prototype.close=function(){return this._closed=this._closed||new i,this._doClose(),this._closed},s.prototype._exec=function(e,t,n,r,i){this._functors[e].call(t,n,function(e,t){e&&(e.message=this._ext.name+": "+e.message),r.call(i,e,t),this._doClose()},this)},s.prototype._doClose=function(){var e=this._functors.incoming,t=this._functors.outgoing;this._closed&&e.pending+t.pending===0&&(this._session&&this._session.close(),this._session=null,this._closed.done())},e.exports=s},function(e,t,n){"use strict";var r=n(22),i=function(e,t){this._session=e,this._method=t,this._queue=new r(i.QUEUE_SIZE),this._stopped=!1,this.pending=0};i.QUEUE_SIZE=8,i.prototype.call=function(e,t,n,r){if(!this._stopped){var i={error:e,message:t,callback:n,context:r,done:!1},s=!1,o=this;if(this._queue.push(i),i.error)return i.done=!0,this._stop(),this._flushQueue();var a=function(e,t){s^(s=!0)&&(e?(o._stop(),i.error=e,i.message=null):i.message=t,i.done=!0,o._flushQueue())};try{this._session[this._method](t,a)}catch(e){a(e)}}},i.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0},i.prototype._flushQueue=function(){for(var e,t=this._queue;t.length>0&&t.peek().done;)(e=t.shift()).error?(this.pending=0,t.clear()):this.pending-=1,e.callback.call(e.context,e.error,e.message)},e.exports=i},function(e,t,n){"use strict";var r=function(){},i={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(var s in i)r.prototype[s]=i[s];e.exports=r},function(e,t,n){"use strict";var r=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},i={read:function(){if(this.data)return this.data;this.data=new Buffer(this.length);for(var e=0,t=0,n=this._chunks.length;t<n;t++)this._chunks[t].copy(this.data,e),e+=this._chunks[t].length;return this.data},pushFrame:function(e){this.rsv1=this.rsv1||e.rsv1,this.rsv2=this.rsv2||e.rsv2,this.rsv3=this.rsv3||e.rsv3,null===this.opcode&&(this.opcode=e.opcode),this._chunks.push(e.payload),this.length+=e.length}};for(var s in i)r.prototype[s]=i[s];e.exports=r},function(e,t,n){"use strict";var r=n(6).Stream,i=n(8),s=n(1),o=n(4),a=n(15),c=n(16),h={"ws:":80,"wss:":443},u=function(e,t,n){this._client=e,this._http=new c("response"),this._origin="object"==typeof e.url?e.url:i.parse(e.url),this._url="object"==typeof t?t:i.parse(t),this._options=n||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new a,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var r=this._url.auth&&new Buffer(this._url.auth,"utf8").toString("base64");r&&this._headers.set("Proxy-Authorization","Basic "+r)};s.inherits(u,r);var p={setHeader:function(e,t){return 0===this._state&&(this._headers.set(e,t),!0)},start:function(){if(0!==this._state)return!1;this._state=1;var e=this._origin,t=e.port||h[e.protocol],n=["CONNECT "+e.hostname+":"+t+" HTTP/1.1",this._headers.toString(),""];return this.emit("data",new Buffer(n.join("\r\n"),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(e){if(!this.writable)return!1;if(this._http.parse(e),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,200===this.statusCode)this.emit("connect",new o.ConnectEvent);else{var t="Can't establish a connection to the server at "+this._origin.href;this.emit("error",new Error(t))}return this.end(),!this._paused},end:function(e){this.writable&&(void 0!==e&&this.write(e),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(var d in p)u.prototype[d]=p[d];e.exports=u},function(e,t,n){"use strict";var r=n(1),i=n(16),s=n(4),o=n(24),a=n(97),c=n(21),h=function(e){s.call(this,null,null,e),this._http=new i("request")};r.inherits(h,s);var u={EVENTS:["open","message","error","close"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(e){if(this._delegate)return this._delegate.parse(e);if(this._http.parse(e),this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var t=this;this._delegate=h.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(e){this._delegate.on(e,function(n){t.emit(e,n)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new s.ConnectEvent)}},_open:function(){this.__queue.forEach(function(e){this._delegate[e[0]].apply(this._delegate,e[1])},this),this.__queue=[]}};for(var p in["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(e){u[e]=function(){return this._delegate?this._delegate[e].apply(this._delegate,arguments):(this.__queue.push([e,arguments]),!0)}}),u)h.prototype[p]=u[p];h.isSecureRequest=function(e){if(e.connection&&void 0!==e.connection.authorized)return!0;if(e.socket&&e.socket.secure)return!0;var t=e.headers;return!!t&&("on"===t.https||"on"===t["x-forwarded-ssl"]||"https"===t["x-forwarded-scheme"]||"https"===t["x-forwarded-proto"])},h.determineUrl=function(e){return(this.isSecureRequest(e)?"wss:":"ws:")+"//"+e.headers.host+e.url},h.http=function(e,t){void 0===(t=t||{}).requireMasking&&(t.requireMasking=!0);var n=e.headers,r=this.determineUrl(e);return n["sec-websocket-version"]?new c(e,r,t):n["sec-websocket-key1"]?new a(e,r,t):new o(e,r,t)},e.exports=h},function(e,t,n){"use strict";var r=n(4),i=n(24),s=n(5),o=function(e){return parseInt(e.match(/[0-9]/g).join(""),10)},a=function(e){return e.match(/ /g).length},c=function(e,t,n){i.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};n(1).inherits(c,i);var h={BODY_SIZE:8,start:function(){return!!i.prototype.start.call(this)&&(this._started=!0,this._sendHandshakeBody(),!0)},close:function(){return 3!==this.readyState&&(this._write(new Buffer([255,0])),this.readyState=3,this.emit("close",new r.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var e=(c=this._request.headers)["sec-websocket-key1"],t=o(e),n=a(e),r=c["sec-websocket-key2"],i=o(r),s=a(r);if(t%n!=0||i%s!=0)return this.emit("error",new Error("Client sent invalid Sec-WebSocket-Key headers")),this.close(),null;this._keyValues=[t/n,i/s];var c=["HTTP/1.1 101 WebSocket Protocol Handshake",this._headers.toString(),""];return new Buffer(c.join("\r\n"),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var e=s.createHash("md5"),t=new Buffer(8+this.BODY_SIZE);return t.writeUInt32BE(this._keyValues[0],0),t.writeUInt32BE(this._keyValues[1],4),new Buffer(this._body).copy(t,8,0,this.BODY_SIZE),e.update(t),new Buffer(e.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var e=this._handshakeSignature();e&&(this._write(e),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(e){if(255!==e)return i.prototype._parseLeadingByte.call(this,e);this._closing=!0,this._length=0,this._stage=1}};for(var u in h)c.prototype[u]=h[u];e.exports=c},function(e,t,n){var r=n(1),i=n(99),s=n(100),o=n(8),a=n(9),c=n(17),h=(n(10),{"http:":80,"https:":443,"ws:":80,"wss:":443}),u=["https:","wss:"],p=function(e,t,n){n=n||{},this.url=e,this._driver=a.client(this.url,{maxLength:n.maxLength,protocols:t}),["open","error"].forEach(function(e){this._driver.on(e,function(){y.headers=y._driver.headers,y.statusCode=y._driver.statusCode})},this);var r=n.proxy||{},p=o.parse(r.origin||this.url),d=p.port||h[p.protocol],f=u.indexOf(p.protocol)>=0,l=function(){y._onConnect()},_=n.tls||{},v=r.origin?r.tls||{}:_,y=this;_.ca=_.ca||n.ca,this._stream=f?s.connect(d,p.hostname,v,l):i.connect(d,p.hostname,l),r.origin&&this._configureProxy(r,_),c.call(this,n)};r.inherits(p,c),p.prototype._onConnect=function(){(this._proxy||this._driver).start()},p.prototype._configureProxy=function(e,t){var n,r=o.parse(this.url),i=u.indexOf(r.protocol)>=0,a=this;if(this._proxy=this._driver.proxy(e.origin),e.headers)for(n in e.headers)this._proxy.setHeader(n,e.headers[n]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(i){var e={socket:a._stream,servername:r.hostname};for(n in t)e[n]=t[n];a._stream=s.connect(e),a._configureStream()}a._driver.io.pipe(a._stream),a._stream.pipe(a._driver.io),a._driver.start()}),this._proxy.on("error",function(e){a._driver.emit("error",e)})},e.exports=p},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("tls")},function(e,t,n){var r=n(6).Stream,i=n(1),s=n(9),o=n(15),a=n(17),c=n(25),h=n(10),u=function(e,t,n){this.writable=!0,n=n||{},this._stream=t.socket,this._ping=n.ping||this.DEFAULT_PING,this._retry=n.retry||this.DEFAULT_RETRY;var r=s.isSecureRequest(e)?"https:":"http:";this.url=r+"//"+e.headers.host+e.url,this.lastEventId=e.headers["last-event-id"]||"",this.readyState=a.CONNECTING;var i=new o,c=this;if(n.headers)for(var h in n.headers)i.set(h,n.headers[h]);if(this._stream&&this._stream.writable){process.nextTick(function(){c._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var u="HTTP/1.1 200 OK\r\nContent-Type: text/event-stream\r\nCache-Control: no-cache, no-store\r\nConnection: close\r\n"+i.toString()+"\r\nretry: "+Math.floor(1e3*this._retry)+"\r\n\r\n";this._write(u),this._stream.on("drain",function(){c.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){c.ping()},1e3*this._ping)),["error","end"].forEach(function(e){c._stream.on(e,function(){c.close()})})}};i.inherits(u,r),u.isEventSource=function(e){return"GET"===e.method&&(e.headers.accept||"").split(/\s*,\s*/).indexOf("text/event-stream")>=0};var p={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(e){if(!this.writable)return!1;try{return this._stream.write(e,"utf8")}catch(e){return!1}},_open:function(){if(this.readyState===a.CONNECTING){this.readyState=a.OPEN;var e=new h("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},write:function(e){return this.send(e)},end:function(e){void 0!==e&&this.write(e),this.close()},send:function(e,t){if(this.readyState>a.OPEN)return!1;e=String(e).replace(/(\r\n|\r|\n)/g,"$1data: ");var n="";return(t=t||{}).event&&(n+="event: "+t.event+"\r\n"),t.id&&(n+="id: "+t.id+"\r\n"),n+="data: "+e+"\r\n\r\n",this._write(n)},ping:function(){return this._write(":\r\n\r\n")},close:function(){if(this.readyState>a.OPEN)return!1;this.readyState=a.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var e=new h("close");return e.initEvent("close",!1,!1),this.dispatchEvent(e),!0}};for(var d in p)u.prototype[d]=p[d];for(var f in c)u.prototype[f]=c[f];e.exports=u},function(e,t,n){var r=n(103),i=n(104);e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||i(o)}},function(e,t,n){var r=n(5);e.exports=function(){return r.randomBytes(16)}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){(function(){var e,r,i={}.hasOwnProperty;r=n(7),e=function(e){function t(e,n,r,i){this.callback=i,t.__super__.constructor.call(this,e,n,r)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,r.ResponseReceiver),t.prototype.protocol="jsonp-polling",t.prototype.max_response_size=1,t.prototype.doSendFrame=function(e){return t.__super__.doSendFrame.call(this,"/**/"+this.callback+"("+JSON.stringify(e)+");\r\n")},t}(),t.app={jsonp:function(t,n,i,s){var o;if(!("c"in t.query||"callback"in t.query))throw{status:500,message:'"callback" parameter required'};if(o="c"in t.query?t.query.c:t.query.callback,/[^a-zA-Z0-9-_.]/.test(o)||o.length>32)throw{status:500,message:'invalid "callback" parameter'};return n.setHeader("X-Content-Type-Options","nosniff"),n.setHeader("Content-Type","application/javascript; charset=UTF-8"),n.writeHead(200),r.register(t,this,new e(t,n,this.options,o)),!0},jsonp_send:function(e,t,n){var i,s,o,a,c;if(!n)throw{status:500,message:"Payload expected."};if("string"==typeof n)try{i=JSON.parse(n)}catch(e){throw{status:500,message:"Broken JSON encoding."}}else i=n.d;if("string"==typeof i&&i)try{i=JSON.parse(i)}catch(e){throw{status:500,message:"Broken JSON encoding."}}if(!i||i.__proto__.constructor!==Array)throw{status:500,message:"Payload expected."};if(null===(o=r.Session.bySessionId(e.session)))throw{status:404};for(s=0,a=i.length;s<a;s++)c=i[s],o.didMessage(c);return t.setHeader("Content-Length","2"),t.setHeader("Content-Type","text/plain; charset=UTF-8"),t.writeHead(200),t.end("ok"),!0}}}).call(this)},function(e,t,n){(function(){var e,r,i,s=function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},o={}.hasOwnProperty;i=n(7),n(2),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return s(t,e),t.prototype.protocol="xhr-streaming",t.prototype.doSendFrame=function(e){return t.__super__.doSendFrame.call(this,e+"\n")},t}(i.ResponseReceiver),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return s(t,r),t.prototype.protocol="xhr-polling",t.prototype.max_response_size=1,t}(),t.app={xhr_options:function(e,t){return t.statusCode=204,t.setHeader("Access-Control-Allow-Methods","OPTIONS, POST"),t.setHeader("Access-Control-Max-Age",t.cache_for),""},xhr_send:function(e,t,n){var r,s,o,a,c;if(!n)throw{status:500,message:"Payload expected."};try{r=JSON.parse(n)}catch(e){throw{status:500,message:"Broken JSON encoding."}}if(!r||r.__proto__.constructor!==Array)throw{status:500,message:"Payload expected."};if(!(o=i.Session.bySessionId(e.session)))throw{status:404};for(s=0,a=r.length;s<a;s++)c=r[s],o.didMessage(c);return t.setHeader("Content-Type","text/plain; charset=UTF-8"),t.writeHead(204),t.end(),!0},xhr_cors:function(e,t,n){var r,i;return this.options.disable_cors?n:(e.headers.origin?(i=e.headers.origin,t.setHeader("Access-Control-Allow-Credentials","true")):i="*",t.setHeader("Access-Control-Allow-Origin",i),t.setHeader("Vary","Origin"),(r=e.headers["access-control-request-headers"])&&t.setHeader("Access-Control-Allow-Headers",r),n)},xhr_poll:function(t,n,r,s){return n.setHeader("Content-Type","application/javascript; charset=UTF-8"),n.writeHead(200),i.register(t,this,new e(t,n,this.options)),!0},xhr_streaming:function(e,t,n,s){return t.setHeader("Content-Type","application/javascript; charset=UTF-8"),t.writeHead(200),t.write(Array(2049).join("h")+"\n"),i.register(e,this,new r(e,t,this.options)),!0}}}).call(this)},function(e,t,n){(function(){var e,r;r=n(2),e='<!DOCTYPE html>\n<html>\n<head>\n  <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n  <script src="{{ sockjs_url }}"><\/script>\n  <script>\n    document.domain = document.domain;\n    SockJS.bootstrap_iframe();\n  <\/script>\n</head>\n<body>\n  <h2>Don\'t panic!</h2>\n  <p>This is a SockJS hidden iframe. It\'s used for cross domain magic.</p>\n</body>\n</html>',t.app={iframe:function(t,n){var i,s,o,a;for(o in s={"{{ sockjs_url }}":this.options.sockjs_url},i=e,s)i=i.replace(o,s[o]);return a='"'+r.md5_hex(i)+'"',"if-none-match"in t.headers&&t.headers["if-none-match"]===a?(n.statusCode=304,""):(n.setHeader("Content-Type","text/html; charset=UTF-8"),n.setHeader("ETag",a),i)}}}).call(this)},function(e,t,n){(function(){var e,r,i,s={}.hasOwnProperty;i=n(2),r=n(7),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,r.ResponseReceiver),t.prototype.protocol="eventsource",t.prototype.doSendFrame=function(e){var n;return n=["data: ",i.escape_selected(e,"\r\n\0"),"\r\n\r\n"],t.__super__.doSendFrame.call(this,n.join(""))},t}(),t.app={eventsource:function(t,n){var i,s;return t.headers.origin&&"null"!==t.headers.origin?(s=t.headers.origin,n.setHeader("Access-Control-Allow-Credentials","true")):s="*",n.setHeader("Content-Type","text/event-stream"),n.setHeader("Access-Control-Allow-Origin",s),n.setHeader("Vary","Origin"),(i=t.headers["access-control-request-headers"])&&n.setHeader("Access-Control-Allow-Headers",i),n.writeHead(200),n.write("\r\n"),r.register(t,this,new e(t,n,this.options)),!0}}}).call(this)},function(e,t,n){(function(){var e,r,i,s={}.hasOwnProperty;n(2),i=n(7),r='<!doctype html>\n<html><head>\n  <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n</head><body><h2>Don\'t panic!</h2>\n  <script>\n    document.domain = document.domain;\n    var c = parent.{{ callback }};\n    c.start();\n    function p(d) {c.message(d);};\n    window.onload = function() {c.stop();};\n  <\/script>',r+=Array(1024-r.length+14).join(" "),r+="\r\n\r\n",e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,i.ResponseReceiver),t.prototype.protocol="htmlfile",t.prototype.doSendFrame=function(e){return t.__super__.doSendFrame.call(this,"<script>\np("+JSON.stringify(e)+");\n<\/script>\r\n")},t}(),t.app={htmlfile:function(t,n){var s;if(!("c"in t.query||"callback"in t.query))throw{status:500,message:'"callback" parameter required'};if(s="c"in t.query?t.query.c:t.query.callback,/[^a-zA-Z0-9-_.]/.test(s))throw{status:500,message:'invalid "callback" parameter'};return n.setHeader("Content-Type","text/html; charset=UTF-8"),n.writeHead(200),n.write(r.replace(/{{ callback }}/g,s)),i.register(t,this,new e(t,n,this.options)),!0}}}).call(this)},function(e,t,n){(function(){var e;e=n(2),t.app={chunking_test:function(t,n,r,i){var s;return n.setHeader("Content-Type","application/javascript; charset=UTF-8"),n.writeHead(200),s=function(e){try{return n.write(e+"\n")}catch(e){}},e.timeout_chain([[0,function(){return s("h")}],[1,function(){return s(Array(2049).join(" ")+"h")}],[5,function(){return s("h")}],[25,function(){return s("h")}],[125,function(){return s("h")}],[625,function(){return s("h")}],[3125,function(){return s("h"),n.end()}]]),!0},info:function(t,n,r){var i;return i={websocket:this.options.websocket,origins:this.options.disable_cors?void 0:["*:*"],cookie_needed:!!this.options.jsessionid,entropy:e.random32()},"function"==typeof this.options.base_url?i.base_url=this.options.base_url():this.options.base_url&&(i.base_url=this.options.base_url),n.setHeader("Content-Type","application/json; charset=UTF-8"),n.writeHead(200),n.end(JSON.stringify(i))},info_options:function(e,t){return t.statusCode=204,t.setHeader("Access-Control-Allow-Methods","OPTIONS, GET"),t.setHeader("Access-Control-Max-Age",t.cache_for),""}}}).call(this)},function(e,t,n){}]).default});
